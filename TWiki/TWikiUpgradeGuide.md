::: {.fullPage}
::: {.twikiMiddleContainer}
::: {.twikiLeftBar}
::: {.twikiLeftBarContents}
**[TWiki](http://TWiki.org/)**

-   **[Welcome](WelcomeGuest){.twikiLink}**
-   **[Register](TWikiRegistration){.twikiLink}**

------------------------------------------------------------------------

-   **TWiki Web**
-   [TWiki Web Home](WebHome){.twikiLink}
-   [Changes](WebChanges){.twikiLink}
-   [Topics](WebTopicList){.twikiLink}
-   [Index](WebIndex){.twikiLink}
-   [Search](WebSearch){.twikiLink}

------------------------------------------------------------------------

-   **TWiki Webs**
    -   [BX12](../BX12/WebHome){.twikiLink}
    -   [Book](../Book/WebHome){.twikiLink}
    -   [CC[^?^](http://www.program-transformation.org/edit/CC/WebHome?topicparent=TWiki.TWikiUpgradeGuide)]{.twikiNewLink
        style="background : #FFFFCE;"}
    -   [Compare](../Compare/WebHome){.twikiLink}
    -   [GPCE06](../GPCE06/WebHome){.twikiLink}
    -   [GPCE08](../GPCE08/WebHome){.twikiLink}
    -   [GPCE09](../GPCE09/WebHome){.twikiLink}
    -   [GPCE10](../GPCE10/WebHome){.twikiLink}
    -   [GPCE11](../GPCE11/WebHome){.twikiLink}
    -   [GPCE12](../GPCE12/WebHome){.twikiLink}
    -   [GPCE13](../GPCE13/WebHome){.twikiLink}
    -   [GPCE14](../GPCE14/WebHome){.twikiLink}
    -   [Gmt](../Gmt/WebHome){.twikiLink}
    -   [Gpce](../Gpce/WebHome){.twikiLink}
    -   [Gpce03](http://www.program-transformation.org/Gpce03/WebHome){.twikiLink}
    -   [Gpce04](../Gpce04/WebHome){.twikiLink}
    -   [Gpce05](../Gpce05/WebHome){.twikiLink}
    -   [Gpceorg](../Gpceorg/WebHome){.twikiLink}
    -   [HART14](../HART14/WebHome){.twikiLink}
    -   [IFIPWG211](http://www.program-transformation.org/IFIPWG211/WebHome){.twikiLink}
    -   [IPA06](../IPA06/WebHome){.twikiLink}
    -   [Main](../Main/WebHome){.twikiLink}
    -   [Octave](../Octave/WebHome){.twikiLink}
    -   [PEPM07](../PEPM07/WebHome){.twikiLink}
    -   [PEPM08](../PEPM08/WebHome){.twikiLink}
    -   [PEPM10](../PEPM10/WebHome){.twikiLink}
    -   [PEPM11](../PEPM11/WebHome){.twikiLink}
    -   [PEPM12](../PEPM12/WebHome){.twikiLink}
    -   [PEPM13](../PEPM13/WebHome){.twikiLink}
    -   [PEPM14](../PEPM14/WebHome){.twikiLink}
    -   [PHP](../PHP/WebHome){.twikiLink}
    -   [Sandbox](../Sandbox/WebHome){.twikiLink}
    -   [Sdf](../Sdf/WebHome){.twikiLink}
    -   [SdfBackup](../SdfBackup/WebHome){.twikiLink}
    -   [Spoofax](../Spoofax/WebHome){.twikiLink}
    -   [Stratego](../Stratego/WebHome){.twikiLink}
    -   [Sts](../Sts/WebHome){.twikiLink}
    -   [TWiki](WebHome){.twikiLink}
    -   [Tiger](../Tiger/WebHome){.twikiLink}
    -   [Tools](../Tools/WebHome){.twikiLink}
    -   [Transform](../Transform/WebHome){.twikiLink}
    -   [Variability](../Variability/WebHome){.twikiLink}
    -   [WGLD](../WGLD/WebHome){.twikiLink}
    -   [WebDSL](../WebDSL/WebHome){.twikiLink}
    -   [default](DefaultWebHome){.twikiLink}

::: {.twikiLeftBarPersonal}
::: {style="overflow:auto; height:1px; width:1px;"}
Changes Index Search

------------------------------------------------------------------------

Webs Book Compare GPCE06 Gmt Gpce Gpce04 Gpce05 IFIPWG211 IPA06 Main
Octave PEPM07 PEPM08 PHP Sandbox Sdf Stratego Sts TWiki Tiger Tools
Transform Variability default
[porn](http://www.estrategiavirtual.com/adult/) [free
porn](http://www.estrategiavirtual.com/free/)
:::
:::
:::
:::

::: {.twikiMain}
::: {.toolBar}
::: {.flexMenuBar}
::: {.flexMenu onmouseover="return showMenu(event, 100);" onmouseout="return hideMenu(event, 100);"}
Page

::: {#flexMenuContent100 .flexMenuContent}
-   [Edit
    Page](http://www.program-transformation.org/edit/TWiki/TWikiUpgradeGuide?t=1536827485)
-   [Rename
    Page](http://www.program-transformation.org/rename/TWiki/TWikiUpgradeGuide)
-   [Attach
    File](http://www.program-transformation.org/attach/TWiki/TWikiUpgradeGuide)

<!-- -->

-   [Printable](http://www.program-transformation.org/view/TWiki/TWikiUpgradeGuide?skin=print.pattern)
-   [Wiki
    Source](http://www.program-transformation.org/view/TWiki/TWikiUpgradeGuide?skin=text&raw=on&contenttype=text/plain)

<!-- -->

-   [Rev
    1](http://www.program-transformation.org/view/TWiki/TWikiUpgradeGuide?rev=1.1)
-   [Total
    History](http://www.program-transformation.org/rdiff/TWiki/TWikiUpgradeGuide)

<!-- -->

-   [More
    \...](http://www.program-transformation.org/oops/TWiki/TWikiUpgradeGuide?template=oopsmore&param1=1.1&param2=1.1)
:::
:::

::: {.flexMenu onmouseover="return showMenu(event, 102);" onmouseout="return hideMenu(event, 102);"}
Web

::: {#flexMenuContent102 .flexMenuContent}
-   [Recent Changes](WebChanges){.twikiLink}
-   [Notify Service](WebNotify){.twikiLink}
-   [News](WebNews){.twikiLink}

<!-- -->

-   [Page Index](WebIndex){.twikiLink}
-   [Search](WebSearch){.twikiLink}

<!-- -->

-   [More
    \...](http://www.program-transformation.org/oops/TWiki/TWikiUpgradeGuide?template=oopsmore&param1=1.1&param2=1.1)
:::
:::

::: {.flexMenu onmouseover="return showMenu(event, 103);" onmouseout="return hideMenu(event, 103);"}
Wiki

::: {#flexMenuContent103 .flexMenuContent}
-   [About
    TWiki](http://www.program-transformation.org/view/TWiki/WebHome)
-   [Text
    Formatting](http://www.program-transformation.org/view/TWiki/TextFormattingRules)

<!-- -->

-   [Registration](http://www.program-transformation.org/view/TWiki/TWikiRegistration)
-   [Change
    Password](http://www.program-transformation.org/view/TWiki/ChangePassword)
-   [Reset
    Password](http://www.program-transformation.org/view/TWiki/ResetPassword)

<!-- -->

-   [Users](http://www.program-transformation.org/view/Main/TWikiUsers)
-   [Groups](http://www.program-transformation.org/view/Main/TWikiGroups)
:::
:::
:::
:::

::: {.twikiTopic}
TWiki Upgrade Guide {#twiki-upgrade-guide .twikiTopicTitle}
===================

::: {.twikiWebTitle}
TWiki
:::

::: {.twikiToc}
-   [TWiki Upgrade Guide](TWikiUpgradeGuide#TWiki_Upgrade_Guide)
    -   [Overview](TWikiUpgradeGuide#Overview)
    -   [Upgrade Requirements](TWikiUpgradeGuide#Upgrade_Requirements)
    -   [Major Changes Compared to TWiki
        01-Feb-2003](TWikiUpgradeGuide#Major_Changes_Compared_to_TWiki)
    -   [Automated Upgrade Procedure from 01-Feb-2003 to 01-Sep-2004
        Release](TWikiUpgradeGuide#Automated_Upgrade_Procedure_from)
    -   [Manual Upgrade Procedure from 01-Feb-2003 to 01-Sep-2004
        Release](TWikiUpgradeGuide#Manual_Upgrade_Procedure_from_01)
    -   [Known Issues](TWikiUpgradeGuide#Known_Issues)
:::

[]{#TWiki_Upgrade_Guide} TWiki Upgrade Guide
============================================

*Upgrade from the previous TWiki 01-Feb-2003 production release to TWiki
01-Sep-2004*

[]{#Overview} Overview
----------------------

This guide describes how to upgrade from TWiki 01-Feb-2003 to TWiki
01-Sep-2004. This is a major new release. You can chose between an
automated upgrade using a script or a manual update.

[]{#Upgrade_Requirements} Upgrade Requirements
----------------------------------------------

-   Please review the
    [AdminSkillsAssumptions](AdminSkillsAssumptions){.twikiLink} before
    you upgrade TWiki
-   To upgrade from a 01-Feb-2003 standard installation to the latest
    01-Sep-2004 TWiki Production Release, follow the instructions below
-   ***NOTE:*** To upgrade from a **pre-01-Feb-2003** TWiki, start with
    [TWikiUpgradeTo01Feb2003](TWikiUpgradeTo01Feb2003){.twikiLink}
-   To upgrade from a Beta of the new release, or if you made custom
    modifications to the application, read through all new reference
    documentation, then use the procedure below as a guideline

[]{#Major_Changes_Compared_to_TWiki}[]{#Major_Changes_Compared_to_TWiki_} Major Changes Compared to TWiki 01-Feb-2003
---------------------------------------------------------------------------------------------------------------------

-   Automatic upgrade script, and easier first-time installation
-   Attractive new skins, using a standard set of CSS classes, and a
    [TWikiSkinBrowser](TWikiSkinBrowser){.twikiLink} to help you choose
-   New easier-to-use save options
-   Many improvements to SEARCH
-   Improved support for internationalisation
-   Better topic management screens
-   More pre-installed Plugins:
    [CommentPlugin](CommentPlugin){.twikiLink},
    [EditTablePlugin](EditTablePlugin){.twikiLink},
    [RenderListPlugin](RenderListPlugin){.twikiLink},
    [SlideShowPlugin](SlideShowPlugin){.twikiLink},
    [SmiliesPlugin](SmiliesPlugin){.twikiLink},
    [SpreadSheetPlugin](SpreadSheetPlugin){.twikiLink},
    [TablePlugin](TablePlugin){.twikiLink}
-   Improved Plugins API and more Plugin callbacks
-   Better support for different authentication methods
-   Many user interface and usability improvements
-   And many more enhancements, see the complete change log at
    [TWikiHistory](TWikiHistory){.twikiLink}

[]{#Automated_Upgrade_Procedure_from} Automated Upgrade Procedure from 01-Feb-2003 to 01-Sep-2004 Release
---------------------------------------------------------------------------------------------------------

With the 01-Sep-2004 Release, for the first time, comes a helper script
for upgrading from a previous version. This feature is currently at beta
stage, it has only been sanity tested under Unix. It should be worth
giving it a try, it won\'t mess up your existing TWiki installation
because it leaves that untouched.

If you would prefer to do things manually than trust a beta script, skip
to the [manual upgrade
procedure](TWikiUpgradeGuide#ManualUpgradeProcedure){.twikiAnchorLink}
below.

The upgrade script is called `"UpgradeTwiki"`, and is found in the root
of the distribution.

It will:

-   Create a new TWiki installation, placing the files from the
    distribution there as appropriate
-   Where possible, merge the changes you\'ve made in your existing
    topics into the new twiki
-   Where not possible, it will tell you, and you can inspect those
    differences manually
-   Create new configuration files for the new TWiki based on your
    existing configuation information
-   Set the permissions in the new TWiki so that it should work straight
    away
-   Attempt to setup authentication for your new TWiki, if you are using
    .htaccess in the old one
-   Tell you what else you need to do

To perform the upgrade, you need to:

-   Check first if there is a newer `UpgradeTwiki` script available, see
    [TWiki:Codev.UpgradeTwiki](http://twiki.org/cgi-bin/view/Codev.UpgradeTwiki "'Codev.UpgradeTwiki' on TWiki.org")
-   Create a new directory for your new installation: Let\'s call this
    `distro/`
-   Put the distribution zip file in `distro/`
-   Unzip it
-   Choose a directory for the new installation. I will call this
    `new_twiki`. This directory must not already exist.
-   Change directory to `distro/` and run:\
    `./UpgradeTwiki <full path to new_twiki>`

Assuming all goes well, `UpgradeTwiki` will give you the final
instructions.

There are a few points worth noting:

-   `UpgradeTwiki` may not be able to merge all the changes you made in
    your existing TWiki into the new installation, but it will tell you
    which ones it couldn\'t deal with
-   `UpgradeTwiki` creates the new installation in a new directory tree.
    It makes a complete copy of all your existing data, so:
    -   Clearly you need to point it to a location where there is enough
        space
    -   If you have symlinks under your `data/` directory in your
        existing installation, these are reproduced as actual
        directories in the new structure. It is up to you to pull these
        sub-directories out again and re-symlink as needed
-   `UpgradeTwiki` doesn\'t deal with custom templates or Plugins, you
    will have to reinstall these in the new installation
-   If you have done tricky stuff with \$OS in your existing `TWiki.cfg`
    file, then you will need to manually examine the new `TWiki.cfg`
    file and possibly put your tricky changes in there manually

If you use it, and would be kind enough to add your experiences to
[TWiki:Codev.UpgradeTwiki](http://twiki.org/cgi-bin/view/Codev.UpgradeTwiki "'Codev.UpgradeTwiki' on TWiki.org"),
it would be much appreciated. The report of your experience will help to
make `UpgradeTwiki` more robust.

[]{#ManualUpgradeProcedure}

[]{#Manual_Upgrade_Procedure_from_01} Manual Upgrade Procedure from 01-Feb-2003 to 01-Sep-2004 Release
------------------------------------------------------------------------------------------------------

The following steps describe the upgrade assuming that `$TWIKIROOT` is
the root of your current 01-Feb-2003 release. As written this will
require some downtime. A process for switching over without downtime is
described at the end of this section.

1.  **Back up and prepare**:
    -   Back up all existing TWiki directories `$TWIKIROOT/bin`,
        `$TWIKIROOT/pub`, `$TWIKIROOT/data`, `$TWIKIROOT/templates`,
        `$TWIKIROOT/lib`
    -   Create a temporary directory and unpack the ZIP file there
2.  **Update files in TWiki root**:
    -   Overwrite all `*.html` and `*.txt` files in `$TWIKIROOT` with
        the new ones
3.  **Update template files**:
    -   Overwrite all template files in `$TWIKIROOT/templates` with the
        new ones
        -   If you have customized your templates, make sure to merge
            those changes back to the new files
    -   If you have customized skins or loaded new skins, make sure to
        merge or apply those changes to the new files
    -   Change to **view** templates and skins:
        -   Add `%BROADCASTMESSAGE%` somewhere on the top of the
            rendered HTML page (see the new `view.tmpl` for reference)
    -   Changes to **edit** templates and skins:
        -   Change the form action from `preview` to `save`:\
            `<form name="main" action="%SCRIPTURLPATH%/save%SCRIPTSUFFIX%/%WEB%/%TOPIC%" method="post">`
        -   Change the topic action to the following:\
            `%TMPL:DEF{"topicaction"}%`\
            `<input type="submit" class="twikiSubmit" name="action" value="Cancel" id="cancel" />`\
            `<input type="submit" class="twikiSubmit" name="action" value="Preview" id="preview" />`\
            `<input type="submit" class="twikiSubmit" name="action" value="Checkpoint" id="checkpoint" />`\
            `<input type="submit" class="twikiSubmit" name="action" value="QuietSave" id="quietsave" />`\
            `<input type="submit" class="twikiSubmit" name="action" value="Save" id="save" />%TMPL:END%`
4.  **Update script files**:
    -   Overwrite all script files in `$TWIKIROOT/bin` with the new
        ones.
        -   If necessary, rename the scrips to include the required
            extension, e.g. `.cgi`
    -   Edit `$TWIKIROOT/bin/setlib.cfg` and point `$twikiLibPath` to
        the ***absolute*** file path of `$TWIKIROOT/lib`
    -   Edit your existing `$TWIKIROOT/bin/.htaccess` file to include a
        directive for the new `rdiffauth` script:\
        `<Files "rdiffauth">`\
        `    require valid-user`\
        `</Files>`
    -   Pay attention to the file and directory permissions, the scripts
        need to be executable, e.g. `chmod 775 $TWIKIROOT/bin/*`
        -   Certain hosted environments require a `755` (do so if you
            get a \"Premature end of script headers\" messages in the
            Apache error log)
    -   For Windows hosts, make sure the correct path to the perl
        interpreter is changed in the first line of every script file.
        See also
        [WindowsInstallCookbook](WindowsInstallCookbook#Editing_the_CGI_scripts){.twikiAnchorLink}
5.  **Update library files**:
    -   Overwrite the `TWiki.cfg` configuration file in `$TWIKIROOT/lib`
        with the new one
    -   Restore the configuration values from the backup. You typically
        need to configure just the ones in the section \"variables that
        need to be changed when installing on a new server\"
    -   Overwrite the `TWiki.pm` library in `$TWIKIROOT/lib` with the
        new one
    -   Copy and overwrite all subdirectories below `$TWIKIROOT/lib`
        with the new ones. Make sure to preserve any extra Plugins you
        might have in `$TWIKIROOT/lib/TWiki/Plugins`
    -   Pay attention to the file and directory permissions, the library
        files should not be executable but the directory files should
        be, e.g. `` chmod 664 `find -type f $TWIKIROOT/lib` `` (for
        files) and `` chmod 775 `find -type d $TWIKIROOT/lib` `` (for
        directories)
6.  **Update data files**:
    -   Run the `bin/testenv` script from the browser (e.g.
        `http://localhost/bin/testenv`) to verify if the cgi-scripts are
        running as user `nobody`. In case not:
        -   The `*,v` RCS repository files delivered with the
            installation package are locked by user `nobody` and need to
            be changed to the user of your cgi-scripts, for example
            `www-data`
        -   Run the `testenv` script from your browser; in the **Fix**
            line you can [relock]{.underline} all the rcs files
            **(recommended)**
        -   Alternatively, execute the shell script commands described
            in
            [TWikiInstallationGuide\#StepTwo](TWikiInstallationGuide#StepTwo){.twikiAnchorLink}
    -   In the temporary `twiki/data/TWiki` directory where you unzipped
        the installation package:
        -   Remove the files you do **not** want to upgrade:
            `InterWikis.*`, `TWikiRegistration.*`,
            `TWikiRegistrationPub.*`, `WebPreferences.*`,
            `WebStatistics.*` and all `WebTopic*` files
    -   Rename in the temporary directory the file
        `$TWIKIROOT/data/TWiki/TWikiPreferences.*` to
        `TWikiPreferencesSave.*`.
    -   Move all remaining `*.txt` and `*.txt,v` files from the
        temporary `data/TWiki` directory to your `$TWIKIROOT/data/TWiki`
        directory, overwriting the existing ones
    -   Merge your original `TWikiPreferencesSave.txt` settings into
        `$TWIKIROOT/data/TWiki/TWikiPreferences.txt`. Notable changes
        are:
        -   New WIKIWEBMASTERNAME setting to avoid notifications being
            trapped by spam filters
        -   New ATTACHFILESIZELIMIT setting for maximum size of
            [FileAttachments](FileAttachment){.twikiLink} in KB, 0 for
            no limit
        -   New READTOPICPREFS and TOPICOVERRIDESUSER settings to allow
            override Preference settings in topics
        -   Changed FINALPREFERENCES:
            -   Set FINALPREFERENCES = PREVIEWBGIMAGE, WIKITOOLNAME,
                WIKIWEBMASTER, SMTPMAILHOST, SMTPSENDERHOST,
                ALLOWWEBMANAGE, READTOPICPREFS, TOPICOVERRIDESUSER
    -   Move the `data/_default` directory from the temporary location
        to your `$TWIKIROOT/data` directory
    -   Make sure that the directories and files below `$TWIKIROOT/data`
        are writable by your cgi-script user
7.  **Adapt the other webs (all other than `TWiki` and `_default`)**:
    -   Add [WebLeftBar](WebLeftBar){.twikiLink} topic. See
        [WebLeftBarExample](WebLeftBarExample){.twikiLink} for a clean
        example, and
        [WebLeftBarCookbook](WebLeftBarCookbook){.twikiLink} for more
        information. ([WebLeftBar](WebLeftBar){.twikiLink} is used by
        the [PatternSkin](PatternSkin){.twikiLink} skin)
    -   Add [WebSearchAdvanced](WebSearchAdvanced){.twikiLink} topic,
        which has this one line:\
        `%INCLUDE{"%TWIKIWEB%.WebSearchAdvanced"}%`
    -   Consider changing [WebPreferences](WebPreferences){.twikiLink}
        settings:
        -   New NOAUTOLINK setting to prevent automatic linking of
            [WikiWords](WikiWord){.twikiLink} and acronyms
        -   Changed FINALPREFERENCES:
            -   Set FINALPREFERENCES = NOSEARCHALL, ATTACHFILESIZELIMIT,
                WIKIWEBMASTER, WEBCOPYRIGHT, WEBTOPICLIST, DENYWEBVIEW,
                ALLOWWEBVIEW, DENYWEBCHANGE, ALLOWWEBCHANGE,
                DENYWEBRENAME, ALLOWWEBRENAME
8.  **Update pub files**:
    -   Move all subdirectories below `pub/TWiki` from your temporary
        directory into your `$TWIKIROOT/pub/TWiki` directory
    -   Make sure that the directories and files below
        `$TWIKIROOT/pub/TWiki` are writable by your cgi-script user
    -   Move all files in `pub/icn` directory from the temporary
        location to your `$TWIKIROOT/pub/icn` directory
9.  **Verify installation**:
    -   Execute the `$TWIKIROOT/bin/testenv` script from your browser
        (e.g. `http://localhost/bin/testenv`) to see if it reports any
        issues; address any potential problems
    -   Test your updated TWiki installation to see if you can view,
        create, edit and rename topics; upload and move attachments;
        register users
    -   Test if the installed Plugins work as expected. You should see
        the list of installed Plugins in
        [TWiki.WebHome](WebHome){.twikiLink}

**Note:** These steps assume a downtime during the time of upgrade. You
could install the new version in parallel to the existing one and switch
over in an instant without affecting the users. As a guideline, install
the new version into `$TWIKIROOT/bin1`, `$TWIKIROOT/lib1`,
`$TWIKIROOT/templates1`, `$TWIKIROOT/data/TWiki1` (from `data/TWiki`),
`$TWIKIROOT/pub/TWiki1` (from `pub/TWiki`), and configure `TWiki.cfg` to
point to the same data and pub directory like the existing installation.
Once tested and ready to go, reconfigure `$TWIKIROOT/bin1/setlib.cfg`
and `$TWIKIROOT/lib1/TWiki.cfg`, then rename `$TWIKIROOT/bin` to
`$TWIKIROOT/bin2`, `$TWIKIROOT/bin1` to `$TWIKIROOT/bin`. Do the same
with the `lib`, `templates` and `data/TWiki` directories.

[]{#Known_Issues} Known Issues
------------------------------

-   Check
    [TWiki:Codev/KnownIssuesOfTWiki01Sep2004](http://twiki.org/cgi-bin/view/Codev/KnownIssuesOfTWiki01Sep2004 "'Codev/KnownIssuesOfTWiki01Sep2004' on TWiki.org")
    for known issues of TWiki 01-Sep-2004 production release

\--
[TWiki:Main.PeterThoeny](http://twiki.org/cgi-bin/view/Main.PeterThoeny "'Main.PeterThoeny' on TWiki.org")
- 29 Aug 2004\

\
[]{#TopicEnd}
:::

::: {.twikiTopicInfo .twikiRevInfo .twikiGrayText .twikiMoved}
:::
:::
:::
:::
