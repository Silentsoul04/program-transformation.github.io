::: {.fullPage}
::: {.twikiMiddleContainer}
::: {.twikiLeftBar}
::: {.twikiLeftBarContents}
**[TWiki](http://TWiki.org/)**

-   **[Welcome](WelcomeGuest){.twikiLink}**
-   **[Register](TWikiRegistration){.twikiLink}**

------------------------------------------------------------------------

-   **TWiki Web**
-   [TWiki Web Home](WebHome){.twikiLink}
-   [Changes](WebChanges){.twikiLink}
-   [Topics](WebTopicList){.twikiLink}
-   [Index](WebIndex){.twikiLink}
-   [Search](WebSearch){.twikiLink}

------------------------------------------------------------------------

-   **TWiki Webs**
    -   [BX12](../BX12/WebHome){.twikiLink}
    -   [Book](../Book/WebHome){.twikiLink}
    -   [CC[^?^](http://www.program-transformation.org/edit/CC/WebHome?topicparent=TWiki.SpreadSheetPlugin)]{.twikiNewLink
        style="background : #FFFFCE;"}
    -   [Compare](../Compare/WebHome){.twikiLink}
    -   [GPCE06](../GPCE06/WebHome){.twikiLink}
    -   [GPCE08](../GPCE08/WebHome){.twikiLink}
    -   [GPCE09](../GPCE09/WebHome){.twikiLink}
    -   [GPCE10](../GPCE10/WebHome){.twikiLink}
    -   [GPCE11](../GPCE11/WebHome){.twikiLink}
    -   [GPCE12](../GPCE12/WebHome){.twikiLink}
    -   [GPCE13](../GPCE13/WebHome){.twikiLink}
    -   [GPCE14](../GPCE14/WebHome){.twikiLink}
    -   [Gmt](../Gmt/WebHome){.twikiLink}
    -   [Gpce](../Gpce/WebHome){.twikiLink}
    -   [Gpce03](http://www.program-transformation.org/Gpce03/WebHome){.twikiLink}
    -   [Gpce04](../Gpce04/WebHome){.twikiLink}
    -   [Gpce05](../Gpce05/WebHome){.twikiLink}
    -   [Gpceorg](../Gpceorg/WebHome){.twikiLink}
    -   [HART14](../HART14/WebHome){.twikiLink}
    -   [IFIPWG211](http://www.program-transformation.org/IFIPWG211/WebHome){.twikiLink}
    -   [IPA06](../IPA06/WebHome){.twikiLink}
    -   [Main](../Main/WebHome){.twikiLink}
    -   [Octave](../Octave/WebHome){.twikiLink}
    -   [PEPM07](../PEPM07/WebHome){.twikiLink}
    -   [PEPM08](../PEPM08/WebHome){.twikiLink}
    -   [PEPM10](../PEPM10/WebHome){.twikiLink}
    -   [PEPM11](../PEPM11/WebHome){.twikiLink}
    -   [PEPM12](../PEPM12/WebHome){.twikiLink}
    -   [PEPM13](../PEPM13/WebHome){.twikiLink}
    -   [PEPM14](../PEPM14/WebHome){.twikiLink}
    -   [PHP](../PHP/WebHome){.twikiLink}
    -   [Sandbox](../Sandbox/WebHome){.twikiLink}
    -   [Sdf](../Sdf/WebHome){.twikiLink}
    -   [SdfBackup](../SdfBackup/WebHome){.twikiLink}
    -   [Spoofax](../Spoofax/WebHome){.twikiLink}
    -   [Stratego](../Stratego/WebHome){.twikiLink}
    -   [Sts](../Sts/WebHome){.twikiLink}
    -   [TWiki](WebHome){.twikiLink}
    -   [Tiger](../Tiger/WebHome){.twikiLink}
    -   [Tools](../Tools/WebHome){.twikiLink}
    -   [Transform](../Transform/WebHome){.twikiLink}
    -   [Variability](../Variability/WebHome){.twikiLink}
    -   [WGLD](../WGLD/WebHome){.twikiLink}
    -   [WebDSL](../WebDSL/WebHome){.twikiLink}
    -   [default](DefaultWebHome){.twikiLink}

::: {.twikiLeftBarPersonal}
::: {style="overflow:auto; height:1px; width:1px;"}
Changes Index Search

------------------------------------------------------------------------

Webs Book Compare GPCE06 Gmt Gpce Gpce04 Gpce05 IFIPWG211 IPA06 Main
Octave PEPM07 PEPM08 PHP Sandbox Sdf Stratego Sts TWiki Tiger Tools
Transform Variability default
[porn](http://www.estrategiavirtual.com/adult/) [free
porn](http://www.estrategiavirtual.com/free/)
:::
:::
:::
:::

::: {.twikiMain}
::: {.toolBar}
::: {.flexMenuBar}
::: {.flexMenu onmouseover="return showMenu(event, 100);" onmouseout="return hideMenu(event, 100);"}
Page

::: {#flexMenuContent100 .flexMenuContent}
-   [Edit
    Page](http://www.program-transformation.org/edit/TWiki/SpreadSheetPlugin?t=1536826249)
-   [Rename
    Page](http://www.program-transformation.org/rename/TWiki/SpreadSheetPlugin)
-   [Attach
    File](http://www.program-transformation.org/attach/TWiki/SpreadSheetPlugin)

<!-- -->

-   [Printable](http://www.program-transformation.org/view/TWiki/SpreadSheetPlugin?skin=print.pattern)
-   [Wiki
    Source](http://www.program-transformation.org/view/TWiki/SpreadSheetPlugin?skin=text&raw=on&contenttype=text/plain)

<!-- -->

-   [Rev
    10](http://www.program-transformation.org/view/TWiki/SpreadSheetPlugin?rev=1.10)
    [(diff 9)](http://www.program-transformation.org/rdiff/TWiki/SpreadSheetPlugin?rev1=1.10&rev2=1.9)
-   [Rev
    9](http://www.program-transformation.org/view/TWiki/SpreadSheetPlugin?rev=1.9)
    [(diff 8)](http://www.program-transformation.org/rdiff/TWiki/SpreadSheetPlugin?rev1=1.9&rev2=1.8)
-   [Rev
    8](http://www.program-transformation.org/view/TWiki/SpreadSheetPlugin?rev=1.8)
    [(diff 7)](http://www.program-transformation.org/rdiff/TWiki/SpreadSheetPlugin?rev1=1.8&rev2=1.7)
-   [Total
    History](http://www.program-transformation.org/rdiff/TWiki/SpreadSheetPlugin)

<!-- -->

-   [More
    \...](http://www.program-transformation.org/oops/TWiki/SpreadSheetPlugin?template=oopsmore&param1=1.10&param2=1.10)
:::
:::

::: {.flexMenu onmouseover="return showMenu(event, 102);" onmouseout="return hideMenu(event, 102);"}
Web

::: {#flexMenuContent102 .flexMenuContent}
-   [Recent Changes](WebChanges){.twikiLink}
-   [Notify Service](WebNotify){.twikiLink}
-   [News](WebNews){.twikiLink}

<!-- -->

-   [Page Index](WebIndex){.twikiLink}
-   [Search](WebSearch){.twikiLink}

<!-- -->

-   [More
    \...](http://www.program-transformation.org/oops/TWiki/SpreadSheetPlugin?template=oopsmore&param1=1.10&param2=1.10)
:::
:::

::: {.flexMenu onmouseover="return showMenu(event, 103);" onmouseout="return hideMenu(event, 103);"}
Wiki

::: {#flexMenuContent103 .flexMenuContent}
-   [About
    TWiki](http://www.program-transformation.org/view/TWiki/WebHome)
-   [Text
    Formatting](http://www.program-transformation.org/view/TWiki/TextFormattingRules)

<!-- -->

-   [Registration](http://www.program-transformation.org/view/TWiki/TWikiRegistration)
-   [Change
    Password](http://www.program-transformation.org/view/TWiki/ChangePassword)
-   [Reset
    Password](http://www.program-transformation.org/view/TWiki/ResetPassword)

<!-- -->

-   [Users](http://www.program-transformation.org/view/Main/TWikiUsers)
-   [Groups](http://www.program-transformation.org/view/Main/TWikiGroups)
:::
:::
:::
:::

::: {.twikiTopic}
Spread Sheet Plugin {#spread-sheet-plugin .twikiTopicTitle}
===================

::: {.twikiWebTitle}
TWiki
:::

[]{#TWiki_Spreadsheet_Plugin}[]{#_TWiki_Spreadsheet_Plugin} TWiki Spreadsheet Plugin
====================================================================================

This Plugin adds speadsheet capabilities to TWiki topics. Formulae like
`%CALC{"$INT(7/3)"}%` are evaluated at page view time. They can be
placed in table cells and outside of tables. In other words, this Plugin
provides general formula evaluation capability, not just classic
spreadsheet functions.

***Example:***

  [Region:](SpreadSheetPlugin@sortcol=0&table=1&up=0#sorted_table "Sort by this column")     [Sales:](SpreadSheetPlugin@sortcol=1&table=1&up=0#sorted_table "Sort by this column")
  ---------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------
  Northeast                                                                                                                                                                    320
  Northwest                                                                                                                                                                    580
  South                                                                                                                                                                        240
  Europe                                                                                                                                                                       610
  Asia                                                                                                                                                                         220
  Total:                                                                                                                                                                      1970
:::
:::
:::
:::

     

***Interactive example:***

Formula: `%CALC{"``"}%`  \
Result:     TWiki Guest

The formula next to \"Total\" is `%CALC{"$SUM( $ABOVE() )"}%`.\
(you see the formula instead of the sum in case the Plugin is not
installed or not enabled.)

::: {.twikiToc}
-   [Syntax Rules](SpreadSheetPlugin#Syntax_Rules)
-   [Built-in Functions](SpreadSheetPlugin#Built_in_Functions)
    -   [ABOVE( ) \-- address range of cells above the current
        cell](SpreadSheetPlugin#ABOVE_address_range_of_cells_abo)
    -   [ABS( num ) \-- absolute value of a
        number](SpreadSheetPlugin#ABS_num_absolute_value_of_a_numb)
    -   [AND( list ) \-- logcial AND of a
        list](SpreadSheetPlugin#AND_list_logcial_AND_of_a_list)
    -   [AVERAGE( list ) \-- average of a list or a range of
        cells](SpreadSheetPlugin#AVERAGE_list_average_of_a_list_o)
    -   [CHAR( number ) \-- ASCII character represented by
        number](SpreadSheetPlugin#CHAR_number_ASCII_character_repr)
    -   [CODE( text ) \-- ASCII numeric value of
        character](SpreadSheetPlugin#CODE_text_ASCII_numeric_value_of)
    -   [COLUMN( offset ) \-- current column
        number](SpreadSheetPlugin#COLUMN_offset_current_column_num)
    -   [COUNTITEMS( list ) \-- count individual items in a
        list](SpreadSheetPlugin#COUNTITEMS_list_count_individual)
    -   [COUNTSTR( list, str ) \-- count the number of cells in a list
        equal to a given
        string](SpreadSheetPlugin#COUNTSTR_list_str_count_the_numb)
    -   [DEF( list ) \-- find first non-empty list item or
        cell](SpreadSheetPlugin#DEF_list_find_first_non_empty_li)
    -   [EVAL( formula ) \-- evaluate a simple
        formula](SpreadSheetPlugin#EVAL_formula_evaluate_a_simple_f)
    -   [EXACT( text1, text2 ) \-- compare two text
        strings](SpreadSheetPlugin#EXACT_text1_text2_compare_two_te)
    -   [FIND( string, text, start ) \-- find one string within another
        string](SpreadSheetPlugin#FIND_string_text_start_find_one)
    -   [FORMAT( type, prec, number ) \-- format a number to a certain
        type and
        precision](SpreadSheetPlugin#FORMAT_type_prec_number_format_a)
    -   [FORMATTIME( serial, text ) \-- convert a serialized date into a
        date string](SpreadSheetPlugin#FORMATTIME_serial_text_convert_a)
    -   [FORMATGMTIME( serial, text ) \-- convert a serialized date into
        a GMT date
        string](SpreadSheetPlugin#FORMATGMTIME_serial_text_convert)
    -   [GET( name ) \-- get the value of a previously set
        variable](SpreadSheetPlugin#GET_name_get_the_value_of_a_prev)
    -   [IF( condition, value if true, value if 0 ) \-- return a value
        based on a
        condition](SpreadSheetPlugin#IF_condition_value_if_true_value)
    -   [INT( formula ) \-- evaluate formula and round down to nearest
        integer](SpreadSheetPlugin#INT_formula_evaluate_formula_and)
    -   [LEFT( ) \-- address range of cells to the left of the current
        cell](SpreadSheetPlugin#LEFT_address_range_of_cells_to_t)
    -   [LENGTH( text ) \-- length of text in
        bytes](SpreadSheetPlugin#LENGTH_text_length_of_text_in_by)
    -   [LIST( range ) \-- convert content of a cell range into a
        list](SpreadSheetPlugin#LIST_range_convert_content_of_a)
    -   [LISTIF( condition, list ) \-- remove elements from a list that
        do not meet a
        condition](SpreadSheetPlugin#LISTIF_condition_list_remove_ele)
    -   [LISTITEM( index, list ) \-- get one element of a
        list](SpreadSheetPlugin#LISTITEM_index_list_get_one_elem)
    -   [LISTMAP( formula, list ) \-- evaluate and update each element
        of a list](SpreadSheetPlugin#LISTMAP_formula_list_evaluate_an)
    -   [LISTREVERSE( list ) \-- opposite order of a
        list](SpreadSheetPlugin#LISTREVERSE_list_opposite_order)
    -   [LISTSIZE( list ) \-- number of elements in a
        list](SpreadSheetPlugin#LISTSIZE_list_number_of_elements)
    -   [LISTSORT( list ) \-- sort a
        list](SpreadSheetPlugin#LISTSORT_list_sort_a_list)
    -   [LISTUNIQUE( list ) \-- remove all duplicates from a
        list](SpreadSheetPlugin#LISTUNIQUE_list_remove_all_dupli)
    -   [LOWER( text ) \-- lower case string of a
        text](SpreadSheetPlugin#LOWER_text_lower_case_string_of)
    -   [MAX( list ) - biggest value of a list or range of
        cells](SpreadSheetPlugin#MAX_list_biggest_value_of_a_list)
    -   [MEDIAN( list ) \-- median of a list or range of
        cells](SpreadSheetPlugin#MEDIAN_list_median_of_a_list_or)
    -   [MIN( list ) \-- smallest value of a list or range of
        cells](SpreadSheetPlugin#MIN_list_smallest_value_of_a_lis)
    -   [MOD( num, divisor ) \-- reminder after dividing num by
        divisor](SpreadSheetPlugin#MOD_num_divisor_reminder_after_d)
    -   [NOP( text ) \--
        no-operation](SpreadSheetPlugin#NOP_text_no_operation)
    -   [NOT( num ) \-- reverse logic of a
        number](SpreadSheetPlugin#NOT_num_reverse_logic_of_a_numbe)
    -   [OR( list ) \-- logcial OR of a
        list](SpreadSheetPlugin#OR_list_logcial_OR_of_a_list)
    -   [PRODUCT( list ) \-- product of a list or range of
        cells](SpreadSheetPlugin#PRODUCT_list_product_of_a_list_o)
    -   [PROPER( text ) \-- properly capitalize
        trxt](SpreadSheetPlugin#PROPER_text_properly_capitalize)
    -   [PROPERSPACE( text ) \-- properly space out
        WikiWords](SpreadSheetPlugin#PROPERSPACE_text_properly_space)
    -   [RAND( max ) \-- random
        number](SpreadSheetPlugin#RAND_max_random_number)
    -   [REPEAT(text) \-- repeat text a number of
        times](SpreadSheetPlugin#REPEAT_text_repeat_text_a_number)
    -   [REPLACE( text, start, num, new ) \-- replace part of a text
        string](SpreadSheetPlugin#REPLACE_text_start_num_new_repla)
    -   [RIGHT( ) \-- address range of cells to the right of the current
        cell](SpreadSheetPlugin#RIGHT_address_range_of_cells_to)
    -   [ROUND( formula, digits ) \-- round a
        number](SpreadSheetPlugin#ROUND_formula_digits_round_a_num)
    -   [ROW( offset ) \-- current row
        number](SpreadSheetPlugin#ROW_offset_current_row_number)
    -   [SEARCH( string, text, start ) \-- search a string within a
        text](SpreadSheetPlugin#SEARCH_string_text_start_search)
    -   [SET( name, value ) \-- set a variable for later
        use](SpreadSheetPlugin#SET_name_value_set_a_variable_fo)
    -   [SETM( name, formula ) \-- update an existing variable based on
        a formula](SpreadSheetPlugin#SETM_name_formula_update_an_exis)
    -   [SIGN( num ) \-- sign of a
        number](SpreadSheetPlugin#SIGN_num_sign_of_a_number)
    -   [SUBSTITUTE( text, old, new, instance, option ) \-- substitute
        text](SpreadSheetPlugin#SUBSTITUTE_text_old_new_instance)
    -   [SUM( list ) \-- sum of a list or range of
        cells](SpreadSheetPlugin#SUM_list_sum_of_a_list_or_range)
    -   [SUMDAYS( list ) \-- sum the days in a list or range of
        cells](SpreadSheetPlugin#SUMDAYS_list_sum_the_days_in_a_l)
    -   [SUMPRODUCT( list, list ) \-- scalar product on ranges of
        cells](SpreadSheetPlugin#SUMPRODUCT_list_list_scalar_prod)
    -   [T( address ) \-- content of a
        cell](SpreadSheetPlugin#T_address_content_of_a_cell)
    -   [TRANSLATE( text, from, to ) \-- translate text from one set of
        characters to
        another](SpreadSheetPlugin#TRANSLATE_text_from_to_translate)
    -   [TIME( text ) \-- convert a date string into a serialized date
        number](SpreadSheetPlugin#TIME_text_convert_a_date_string)
    -   [TIMEADD( serial, value, unit ) \-- add a value to a serialized
        date](SpreadSheetPlugin#TIMEADD_serial_value_unit_add_a)
    -   [TIMEDIFF( serial\_1, serial\_2, unit ) \-- time difference
        between two serialized
        dates](SpreadSheetPlugin#TIMEDIFF_serial_1_serial_2_unit)
    -   [TODAY( ) \-- serialized date of today at midnight
        GMT](SpreadSheetPlugin#TODAY_serialized_date_of_today_a)
    -   [TRIM( text ) \-- trim spaces from
        text](SpreadSheetPlugin#TRIM_text_trim_spaces_from_text)
    -   [UPPER( text ) \-- upper case string of a
        text](SpreadSheetPlugin#UPPER_text_upper_case_string_of)
    -   [VALUE( text ) \-- convert text to
        number](SpreadSheetPlugin#VALUE_text_convert_text_to_numbe)
    -   [WORKINGDAYS( serial\_1, serial\_2 ) \-- working days between
        two serialized
        dates](SpreadSheetPlugin#WORKINGDAYS_serial_1_serial_2_wo)
-   [Bug Tracking Example](SpreadSheetPlugin#Bug_Tracking_Example)
-   [Plugin Settings](SpreadSheetPlugin#Plugin_Settings)
-   [Plugin Installation
    Instructions](SpreadSheetPlugin#Plugin_Installation_Instructions)
-   [Plugin Info](SpreadSheetPlugin#Plugin_Info)
:::

[]{#Syntax_Rules} Syntax Rules
------------------------------

The action of this Plugin is triggered by the `%CALC{"..."}%` variable,
which gets rendered according to the built-in function(s) found between
the quotes.

-   Built-in function are of format `$FUNCNAME(parameter)`
-   Functions may be nested, e.g.
    `%CALC{"$SUM( R2:C$COLUMN(0)..R$ROW(-1):C$COLUMN(0) )"}%`
-   Functions are evaluated from left to right, and from inside to
    outside if nested
-   The function parameter can be text; a mathematical formula; a cell
    address; or a range of cell addresses
-   Multiple parameters form a list; they are separated by a comma,
    followed by optional space, e.g. `%CALC{"$SUM( 3, 5, 7 )"}%`
-   A table cell can be addressed as `R1:C1`. Table address matrix:
      --------- --------- --------- ---------
      `R1:C1`   `R1:C2`   `R1:C3`   `R1:C4`
      `R2:C1`   `R2:C2`   `R2:C3`   `R2:C4`
      --------- --------- --------- ---------

-   A table cell range is defined by two cell addresses separated by
    `".."`, e.g. \"row 1 through 20, column 3\" is: `R1:C3..R20:C3`
-   Lists can refer to values and/or table cell ranges, e.g.
    `%CALC{"$SUM( 3, 5, $T(R1:C7), R1:C11..R1:C15 )"}%`
-   Formulae can only reference cells in the current or preceeding row
    of the current table; they may not reference cells below the current
    table row
-   Formulae can also be placed outside of tables; they can reference
    cells in the preceeding table

[]{#Built_in_Functions} Built-in Functions
------------------------------------------

Conventions for Syntax:

-   Required parameters are indicated in `( bold )`
-   Optional parameters are indicated in `( bold italic )`

[]{#FuncABOVE}

### []{#ABOVE_address_range_of_cells_abo} ABOVE( ) \-- address range of cells above the current cell

-   Syntax: `$ABOVE( )`
-   Example: `%CALC{"$SUM($ABOVE())"}%` returns the sum of cells above
    the current cell
-   Related: `$LEFT()`, `$RIGHT()`

[]{#FuncABS}

### []{#ABS_num_absolute_value_of_a_numb} ABS( num ) \-- absolute value of a number

-   Syntax: `$ABS( num )`
-   Example: `%CALC{"$ABS(-12.5)"}%` returns `12.5`
-   Related: `$SIGN()`

[]{#FuncAND}

### []{#AND_list_logcial_AND_of_a_list} AND( list ) \-- logcial AND of a list

-   Syntax: `$AND( list )`
-   Example: `%CALC{"$AND(1, 0, 1)"}%` returns `0`
-   Related: `$NOT()`, `$IF()`, `$OR()`

[]{#FuncAVERAGE}

### []{#AVERAGE_list_average_of_a_list_o} AVERAGE( list ) \-- average of a list or a range of cells

-   Syntax: `$AVERAGE( list )`
-   Example: `%CALC{"$AVERAGE(R2:C5..R$ROW(-1):C5)"}%` returns the
    average of column 5, excluding the title row
-   Related: `$LIST()`, `$MAX()`, `$MEDIAN()`, `$MIN()`

[]{#FuncCHAR}

### []{#CHAR_number_ASCII_character_repr} CHAR( number ) \-- ASCII character represented by number

-   Syntax: `$CHAR( number )`
-   Example: Example: `%CALC{"$CHAR(97)"}%` returns `a`
-   Related: `$CODE()`

[]{#FuncCODE}

### []{#CODE_text_ASCII_numeric_value_of} CODE( text ) \-- ASCII numeric value of character

-   The ASCII numeric value of the first character in text
-   Syntax: `$CODE( text )`
-   Example: `%CALC{"$CODE(abc)"}%` returns `97`
-   Related: `$CHAR()`

[]{#FuncCOLUMN}

### []{#COLUMN_offset_current_column_num} COLUMN( offset ) \-- current column number

-   The current table column number with an optional offset
-   Syntax: `$COLUMN( offset )`
-   Example: `%CALC{"$COLUMN()"}%` returns `2` for the second column
-   Related: `$ROW()`, `$T()`

[]{#FuncCOUNTITEMS}

### []{#COUNTITEMS_list_count_individual} COUNTITEMS( list ) \-- count individual items in a list

-   Syntax: `$COUNTITEMS( list )`
-   Example: `%CALC{"$COUNTITEMS($ABOVE())"}%` returns
    `Closed: 1, Open: 2` assuming one cell above the current cell
    contains `Closed` and two cells contain `Open`
-   Related: `$COUNTSTR()`, `$LIST()`

[]{#FuncCOUNTSTR}

### []{#COUNTSTR_list_str_count_the_numb} COUNTSTR( list, str ) \-- count the number of cells in a list equal to a given string

-   Count the number of cells in a list equal to a given string (if str
    is specified), or counts the number of non empty cells in a list
-   Syntax: `$COUNTSTR( list, str )`
-   Example: `%CALC{"$COUNTSTR($ABOVE())"}%` counts the number of non
    empty cells above the current cell
-   Example: `%CALC{"$COUNTSTR($ABOVE(), DONE)"}%` counts the number of
    cells equal to `DONE`
-   Related: `$COUNTITEMS()`, `$LIST()`

[]{#FuncDEF}

### []{#DEF_list_find_first_non_empty_li} DEF( list ) \-- find first non-empty list item or cell

-   Returns the first list item or cell reference that is not empty
-   Syntax: `$DEF( list )`
-   Example: `%CALC{"$DEF(R1:C1..R1:C3)"}%`
-   Related: `$COUNTSTR()`, `$LISTIF()`, `$LIST()`

[]{#FuncEVAL}

### []{#EVAL_formula_evaluate_a_simple_f} EVAL( formula ) \-- evaluate a simple formula

-   Addition, substraction, multiplication, division and modulus of
    numbers are supported. Any nesting is permitted
-   Syntax: `$EVAL( formula )`
-   Example: `%CALC{"$EVAL( (5 * 3) / 2 + 1.1 )"}%` returns `8.6`
-   Related: `$INT()`, `$MOD()`, `$ROUND()`, `$VALUE()`

[]{#FuncEXACT}

### []{#EXACT_text1_text2_compare_two_te} EXACT( text1, text2 ) \-- compare two text strings

-   Compares two text strings and returns `1` if they are exactly the
    same, or `0` if not
-   Syntax: `$EXACT( text1, text2 )`
-   Example: `%CALC{"$EXACT(foo, Foo)"}%` returns `0`
-   Example: `%CALC{"$EXACT(foo, $LOWER(Foo))"}%` returns `1`
-   Related: `$IF()`, `$TRIM()`

[]{#FuncFIND}

### []{#FIND_string_text_start_find_one}[]{#FIND_string_text_start_find_one_} FIND( string, text, start ) \-- find one string within another string

-   Finds one text `string`, within another `text`, and returns the
    number of the starting position of `string`, from the first
    character of `text`. This search is case sensitive and is not a
    regular expression search; use `$SEARCH()` for regular expression
    searching. Starting position is 1; a 0 is returned if nothing is
    matched.
-   Syntax: `$FIND( string, text, start )`
-   Example: `%CALC{"$FIND(f, fluffy)"}%` returns `1`
-   Example: `%CALC{"$FIND(f, fluffy, 2)"}%` returns `4`
-   Example: `%CALC{"$FIND(@, fluffy, 1)"}%` returns `0`
-   Related: `$REPLACE()`, `$SEARCH()`

[]{#FuncFORMAT}

### []{#FORMAT_type_prec_number_format_a} FORMAT( type, prec, number ) \-- format a number to a certain type and precision

-   Type can be COMMA for comma format, DOLLAR for Dollar format, NUMBER
    for number, and PERCENT for percent format
-   Syntax: `$FORMAT( type, prec, number )`
-   Example: `%CALC{"$FORMAT(COMMA, 2, 12345.6789)"}%` returns
    `12,345.68`
-   Example: `%CALC{"$FORMAT(DOLLAR, 2, 12345.67)"}%` returns
    `$12,345.68`
-   Example: `%CALC{"$FORMAT(NUMBER, 1, 12345.67)"}%` returns `12345.7`
-   Example: `%CALC{"$FORMAT(PERCENT, 1, 0.1234567)"}%` returns `12.3%`
-   Related: `$ROUND()`

[]{#FuncFORMATTIME}

### []{#FORMATTIME_serial_text_convert_a} FORMATTIME( serial, text ) \-- convert a serialized date into a date string

-   The following variables in `text` are expanded: `$second` (seconds,
    00..59); `$minute` (minutes, 00..59); `$hour` (hours, 00..23);
    `$day` (day of month, 01..31); `$month` (month, 01..12); `$mon`
    (month in text format, Jan..Dec); `$year` (4 digit year, 1999);
    `$ye` (2 digit year, 99), `$wd` (day number of the week, 1 for
    Sunday, 2 for Monday, etc), `$wday` (day of the week, Sun..Sat),
    `$weekday` (day of the week, Sunday..Saturday), `$yearday` (day of
    the year, 1..365, or 1..366 in leap years). Date is assumed to be
    server time; add `GMT` to indicate Greenwich time zone.
-   Syntax: `$FORMATTIME( serial, text )`
-   Example: `%CALC{"$FORMATTIME(0, $year/$month/$day GMT)"}%` returns
    `1970/01/01 GMT`
-   Related: `$FORMATGMTIME()`, `$TIME()`, `$TIMEADD()`, `$TIMEDIFF()`,
    `$TODAY()`

[]{#FuncFORMATGMTIME}

### []{#FORMATGMTIME_serial_text_convert} FORMATGMTIME( serial, text ) \-- convert a serialized date into a GMT date string

-   The date string represents the time in Greenwich time zone. Same
    variable expansion as in `$FORMATTIME()`.
-   Syntax: `$FORMATGMTIME( serial, text )`
-   Example: `%CALC{"$FORMATGMTIME(1041379200, $day $mon $year)"}%`
    returns `01 Jan 2003`
-   Related: `$FORMATTIME()`, `$TIME()`, `$TIMEADD()`, `$TIMEDIFF()`,
    `$TODAY()`

[]{#FuncGET}

### []{#GET_name_get_the_value_of_a_prev} GET( name ) \-- get the value of a previously set variable

-   Specify the variable name (alphanumeric characters and underscores).
    An empty string is returned if the variable does not exist. Use
    `$SET()` to set a variable first. Unlike table ranges, variables
    live for the time of the page view and persist across tables, i.e.
    you can use it to summarize results across several tables.
-   Syntax: `$GET( name )`
-   Example: `%CALC{"$GET(my_total)"}%` returns the value of the
    `my_total` variable
-   Related: `$SET()`, `$SETM()`

[]{#FuncIF}

### []{#IF_condition_value_if_true_value} IF( condition, value if true, value if 0 ) \-- return a value based on a condition

-   The condition can be a number (where `0` means condition not met),
    or two numbers with a comparison operator `<` (less than), `<=`
    (less than or equal), `==` (equal), `!=` (not equal), `>=` (greater
    than or equal), `>` (greater than).
-   Syntax: `$IF( condition, value if true, value if 0 )`
-   Example: `%CALC{"$IF($T(R1:C5) > 1000, Over Budget, OK)"}%` returns
    `Over Budget` if value in R1:C5 is over 1000, `OK` if not
-   Example: `%CALC{"$IF($EXACT($T(R1:C2),), empty, $T(R1:C2))"}%`
    returns the content of R1:C2 or `empty` if empty
-   Example: `%CALC{"$SET(val, $IF($T(R1:C2) == 0, zero, $T(R1:C2)))"}%`
    sets a variable conditionally
-   Related: `$AND()`, `$EXACT()`, `$LISTIF()`, `$NOT()`, `$OR()`

[]{#FuncINT}

### []{#INT_formula_evaluate_formula_and} INT( formula ) \-- evaluate formula and round down to nearest integer

-   Addition, substraction, multiplication, division and modulus of
    numbers are supported. Any nesting is permitted
-   Syntax: `$INT( formula )`
-   Example: `%CALC{"$INT(10 / 4)"}%` returns `2`
-   Related: `$EVAL()`, `$ROUND()`, `$VALUE()`

[]{#FuncLEFT}

### []{#LEFT_address_range_of_cells_to_t} LEFT( ) \-- address range of cells to the left of the current cell

-   Syntax: `$LEFT( )`
-   Example: `%CALC{"$SUM($LEFT())"}%` returns the sum of cells to the
    left of the current cell
-   Related: `$ABOVE()`, `$RIGHT()`

[]{#FuncLENGTH}

### []{#LENGTH_text_length_of_text_in_by} LENGTH( text ) \-- length of text in bytes

-   Syntax: `$LENGTH( text )`
-   Example: `%CALC{"$LENGTH(abcd)"}%` returns `4`
-   Related: `$LISTSIZE()`

[]{#FuncLIST}

### []{#LIST_range_convert_content_of_a}[]{#LIST_range_convert_content_of_a_} LIST( range ) \-- convert content of a cell range into a list

-   Convert the content of a range of cells into a flat list, delimited
    by comma. Cells containing commas are merged into the list
-   Syntax: `$LIST( range )`
-   Example: `%CALC{"$LIST($LEFT())"}%` returns
    `Apples, Lemons, Oranges, Kiwis` assuming the cells to the left
    contain `| Apples | Lemons, Oranges | Kiwis |`
-   Related: `$AVERAGE()`, `$COUNTITEMS()`, `$COUNTSTR()`, `$DEF()`,
    `$LISTIF()`, `$LISTITEM()`, `$LISTMAP()`, `$LISTREVERSE()`,
    `$LISTSIZE()`, `$LISTSORT()`, `$LISTUNIQUE()`, `$MAX()`,
    `$MEDIAN()`, `$MIN()`, `$PRODUCT()`, `$SUM()`, `$SUMDAYS()`,
    `$SUMPRODUCT()`

[]{#FuncLISTIF}

### []{#LISTIF_condition_list_remove_ele} LISTIF( condition, list ) \-- remove elements from a list that do not meet a condition

-   In addition to the condition described in `$IF()`, you can use
    `$item` to indicate the current element, and `$index` for the list
    index, starting at 1
-   Syntax: `$LISTIF( condition, list )`
-   Example: `%CALC{"$LISTIF($item > 12, 14, 7, 25)"}%` returns `14, 25`
-   Example: `%CALC{"$LISTIF($NOT($EXACT($item,)), A, B, , E)"}%`
    returns non-empty elements `A, B, E`
-   Example: `%CALC{"$LISTIF($index > 2, A, B, C, D)"}%` returns `C, D`
-   Related: `$IF()`, `$LIST()`, `$LISTITEM()`, `$LISTMAP()`,
    `$LISTREVERSE()`, `$LISTSIZE()`, `$LISTSORT()`, `$LISTUNIQUE()`,
    `$SUM()`

[]{#FuncLISTITEM}

### []{#LISTITEM_index_list_get_one_elem} LISTITEM( index, list ) \-- get one element of a list

-   Index is 1 to size of list; use a negative number to count from the
    end of the list
-   Syntax: `$LISTITEM( index, list )`
-   Example: `%CALC{"$LISTITEM(2, Apple, Orange, Apple, Kiwi)"}%`
    returns `Orange`
-   Example: `%CALC{"$LISTITEM(-1, Apple, Orange, Apple, Kiwi)"}%`
    returns `Kiwi`
-   Related: `$COUNTITEMS()`, `$COUNTSTR()`, `$LIST()`, `$LISTIF()`,
    `$LISTMAP()`, `$LISTREVERSE()`, `$LISTSIZE()`, `$LISTSORT()`,
    `$LISTUNIQUE()`, `$SUM()`

[]{#FuncLISTMAP}

### []{#LISTMAP_formula_list_evaluate_an} LISTMAP( formula, list ) \-- evaluate and update each element of a list

-   In the formula you can use `$item` to indicate the element; `$index`
    to show the index of the list, starting at 1
-   Syntax: `$LISTMAP( formula, list )`
-   Example: `%CALC{"$LISTMAP($index: $EVAL(2 * $item), 3, 5, 7, 11)"}%`
    returns `1: 6, 2: 10, 3: 14, 4: 22`
-   Related: `$COUNTITEMS()`, `$COUNTSTR()`, `$LIST()`, `$LISTIF()`,
    `$LISTITEM()`, `$LISTREVERSE()`, `$LISTSIZE()`, `$LISTSORT()`,
    `$LISTUNIQUE()`, `$SUM()`

[]{#FuncLISTREVERSE}

### []{#LISTREVERSE_list_opposite_order}[]{#LISTREVERSE_list_opposite_order_} LISTREVERSE( list ) \-- opposite order of a list

-   Syntax: `$LISTREVERSE( list )`
-   Example: `%CALC{"$LISTREVERSE(Apple, Orange, Apple, Kiwi)"}%`
    returns `Kiwi, Apple, Orange, Apple`
-   Related: `$COUNTITEMS()`, `$COUNTSTR()`, `$LIST()`, `$LISTIF()`,
    `$LISTITEM()`, `$LISTMAP()`, `$LISTSIZE()`, `$LISTSORT()`,
    `$LISTUNIQUE()`, `$SUM()`

[]{#FuncLISTSIZE}

### []{#LISTSIZE_list_number_of_elements} LISTSIZE( list ) \-- number of elements in a list

-   Syntax: `$LISTSIZE( list )`
-   Example: `%CALC{"$LISTSIZE(Apple, Orange, Apple, Kiwi)"}%` returns
    `4`
-   Related: `$COUNTITEMS()`, `$COUNTSTR()`, `$LIST()`, `$LISTIF()`,
    `$LISTITEM()`, `$LISTMAP()`, `$LISTREVERSE()`, `$LISTSORT()`,
    `$LISTUNIQUE()`, `$SUM()`

[]{#FuncLISTSORT}

### []{#LISTSORT_list_sort_a_list} LISTSORT( list ) \-- sort a list

-   Sorts a list in ASCII order, or numerically if all elements are
    numeric
-   Syntax: `$LISTSORT( list )`
-   Example: `%CALC{"$LISTSORT(Apple, Orange, Apple, Kiwi)"}%` returns
    `Apple, Apple, Kiwi, Orange`
-   Related: `$COUNTITEMS()`, `$COUNTSTR()`, `$LIST()`, `$LISTIF()`,
    `$LISTITEM()`, `$LISTMAP()`, `$LISTREVERSE()`, `$LISTSIZE()`,
    `$LISTUNIQUE()`, `$SUM()`

[]{#FuncLISTUNIQUE}

### []{#LISTUNIQUE_list_remove_all_dupli} LISTUNIQUE( list ) \-- remove all duplicates from a list

-   Syntax: `$LISTUNIQUE( list )`
-   Example: `%CALC{"$LISTUNIQUE(Apple, Orange, Apple, Kiwi)"}%` returns
    `Apple, Orange, Kiwi`
-   Related: `$COUNTITEMS()`, `$COUNTSTR()`, `$LIST()`, `$LISTIF()`,
    `$LISTITEM()`, `$LISTMAP()`, `$LISTREVERSE()`, `$LISTSIZE()`,
    `$LISTSORT()`, `$SUM()`

[]{#FuncLOWER}

### []{#LOWER_text_lower_case_string_of}[]{#LOWER_text_lower_case_string_of_} LOWER( text ) \-- lower case string of a text

-   Syntax: `$LOWER(text)`
-   Example: `%CALC{"$LOWER( $T(R1:C5) )"}%` returns the lower case
    string of the text in cell `R1:C5`
-   Related: `$PROPER()`, `$PROPERSPACE()`, `$TRIM()`, `$UPPER()`

[]{#FuncMAX}

### []{#MAX_list_biggest_value_of_a_list} MAX( list ) - biggest value of a list or range of cells

-   Syntax: `$MAX( list )`
-   Example: To find the biggest number to the left of the current cell,
    write: `%CALC{"$MAX($LEFT())"}%`
-   Related: `$LIST()`, `$MEDIAN()`, `$MIN()`

[]{#FuncMEDIAN}

### []{#MEDIAN_list_median_of_a_list_or}[]{#MEDIAN_list_median_of_a_list_or_} MEDIAN( list ) \-- median of a list or range of cells

-   Syntax: `$MEDIAN( list )`
-   Example: `%CALC{"$MEDIAN(3, 9, 4, 5)"}%` returns `4.5`
-   Related: `$LIST()`, `$MAX()`, `$MIN()`

[]{#FuncMIN}

### []{#MIN_list_smallest_value_of_a_lis} MIN( list ) \-- smallest value of a list or range of cells

-   Syntax: `$MIN( list )`
-   Example: `%CALC{"$MIN(15, 3, 28)"}%` returns `3`
-   Related: `$LIST()`, `$MAX()`, `$MEDIAN()`

[]{#FuncMOD}

### []{#MOD_num_divisor_reminder_after_d} MOD( num, divisor ) \-- reminder after dividing `num` by `divisor`

-   Syntax: `$MOD( num, divisor )`
-   Example: `%CALC{"$MOD(7, 3)"}%` returns `1`
-   Related: `$EVAL()`, `$()`

[]{#FuncNOP}

### []{#NOP_text_no_operation} NOP( text ) \-- no-operation

-   Useful to change the order of Plugin execution. For example, it
    allows preprossing to be done before `%SEARCH{}%` is evaluated. The
    percent character \'%\' can be escaped with `$per`
-   Syntax: `$NOP( text )`

[]{#FuncNOT}

### []{#NOT_num_reverse_logic_of_a_numbe} NOT( num ) \-- reverse logic of a number

-   Returns 0 if `num` is not zero, 1 if zero
-   Syntax: `$NOT( num )`
-   Example: `%CALC{"$NOT(0)"}%` returns `1`
-   Related: `$AND()`, `$IF()`, `$OR()`

[]{#FuncOR}

### []{#OR_list_logcial_OR_of_a_list} OR( list ) \-- logcial OR of a list

-   Syntax: `$OR( list )`
-   Example: `%CALC{"$OR(1, 0, 1)"}%` returns `1`
-   Related: `$AND()`, `$IF()`, `$NOT()`

[]{#FuncPRODUCT}

### []{#PRODUCT_list_product_of_a_list_o} PRODUCT( list ) \-- product of a list or range of cells

-   Syntax: `$PRODUCT( list )`
-   Example: To calculate the product of the cells to the left of the
    current one use `%CALC{"$PRODUCT($LEFT())"}%`
-   Related: `$LIST()`, `$PRODUCT()`, `$SUM()`, `$SUMPRODUCT()`

[]{#FuncPROPER}

### []{#PROPER_text_properly_capitalize}[]{#PROPER_text_properly_capitalize_} PROPER( text ) \-- properly capitalize trxt

-   Capitalize letters that follow any character other than a letter;
    convert all other letters to lowercase letters
-   Syntax: `$PROPER( text )`
-   Example: `%CALC{"PROPER(a small STEP)"}%` returns `A Small Step`
-   Example: `%CALC{"PROPER(f1 (formula-1))"}%` returns `F1 (Formula-1)`
-   Related: `$LOWER()`, `$PROPERSPACE()`, `$TRIM()`, `$UPPER()`

[]{#FuncPROPERSPACE}

### []{#PROPERSPACE_text_properly_space}[]{#PROPERSPACE_text_properly_space_} PROPERSPACE( text ) \-- properly space out WikiWords

-   Properly spaces out [WikiWords](WikiWord){.twikiLink} preceeded by
    white space, parenthesis, or `][`. Words listed in the DONTSPACE
    [TWikiPreferences](TWikiPreferences){.twikiLink} variable or
    DONTSPACE Plugins setting are excluded
-   Syntax: `$PROPERSPACE( text )`
-   Example: Assuming DONTSPACE contains MacDonald:
    `%CALC{"PROPERSPACE(Old MacDonald had a ServerFarm, EeEyeEeEyeOh"}%`
    returns `Old MacDonald had a Server Farm, Ee Eye Ee Eye Oh`
-   Related: `$LOWER()`, `$PROPER()`, `$TRIM()`, `$UPPER()`

[]{#FuncRAND}

### []{#RAND_max_random_number} RAND( max ) \-- random number

-   Random number, evenly distributed between 0 and `max`, or 0 and 1 if
    max is not specified
-   Syntax: `$RAND( max )`
-   Related: `$EVAL()`

[]{#FuncREPEAT}

### []{#REPEAT_text_repeat_text_a_number} REPEAT(text) \-- repeat text a number of times

-   Syntax: `$REPEAT( text )`
-   Example: `%CALC{"$REPEAT(/\, 5)"}%` returns `/\/\/\/\/\`

[]{#FuncREPLACE}

### []{#REPLACE_text_start_num_new_repla} REPLACE( text, start, num, new ) \-- replace part of a text string

-   Replace `num` number of characters of text string `text`, starting
    at `start`, with new text `new`. Starting position is 1; use a
    negative `start` to count from the end of the text
-   Syntax: `$REPLACE( text, start, num, new )`
-   Example: `%CALC{"$REPLACE(abcdefghijk,6,5,*)"}%` returns `abcde*k`
-   Related: `$FIND()`, `$SEARCH()`, `$SUBSTITUTE()`, `$TRANSLATE()`

[]{#FuncRIGHT}

### []{#RIGHT_address_range_of_cells_to}[]{#RIGHT_address_range_of_cells_to_} RIGHT( ) \-- address range of cells to the right of the current cell

-   Syntax: `$RIGHT( )`
-   Example: `%CALC{"$SUM($RIGHT())"}%` returns the sum of cells to the
    right of the current cell
-   Related: `$ABOVE()`, `$LEFT()`

[]{#FuncROUND}

### []{#ROUND_formula_digits_round_a_num} ROUND( formula, digits ) \-- round a number

-   Evaluates a simple `formula` and rounds the result up or down to the
    number of digits if `digits` is positive; to the nearest integer if
    digits is missing; or to the left of the decimal point if digits is
    negative
-   Syntax: `$ROUND( formula, digits )`
-   Example: `%CALC{"$ROUND(3.15, 1)"}%` returns `3.2`
-   Example: `%CALC{"$ROUND(3.149, 1)"}%` returns `3.1`
-   Example: `%CALC{"$ROUND(-2.475, 2)"}%` returns `-2.48`
-   Example: `%CALC{"$ROUND(34.9, -1)"}%` returns `30`
-   Related: `$INT()`, `$FORMAT()`

[]{#FuncROW}

### []{#ROW_offset_current_row_number} ROW( offset ) \-- current row number

-   The current table row number with an optional offset
-   Syntax: `$ROW( offset )`
-   Example: To get the number of rows excluding table heading (first
    row) and summary row (last row you are in), write:
    `%CALC{"$ROW(-2)"}%`
-   Related: `$COLUMN()`, `$T()`

[]{#FuncSEARCH}

### []{#SEARCH_string_text_start_search}[]{#SEARCH_string_text_start_search_} SEARCH( string, text, start ) \-- search a string within a text

-   Finds one text `string`, within another `text`, and returns the
    number of the starting position of `string`, from the first
    character of `text`. This search is a
    [RegularExpression](RegularExpression){.twikiLink} search; use
    `$FIND()` for non-regular expression searching. Starting position is
    1; a 0 is returned if nothing is matched
-   Syntax: `$SEARCH( string, text, start )`
-   Example: `%CALC{"$SEARCH([uy], fluffy)"}%` returns `3`
-   Example: `%CALC{"$SEARCH([uy], fluffy, 3)"}%` returns `6`
-   Example: `%CALC{"$SEARCH([abc], fluffy,)"}%` returns `0`
-   Related: `$FIND()`, `$REPLACE()`

[]{#FuncSET}

### []{#SET_name_value_set_a_variable_fo} SET( name, value ) \-- set a variable for later use

-   Specify the variable name (alphanumeric characters and underscores)
    and the value. The value may contain a formula; formulas are
    evaluated before the variable assignment. This function returns no
    output. Use `$GET()` to retrieve variables. Unlike table ranges,
    variables live for the time of the page view and persist across
    tables, i.e. you can use it to summarize results across several
    tables
-   Syntax: `$SET( name, value )`
-   Example: `%CALC{"$SET(my_total, $SUM($ABOVE()))"}%` sets the
    `my_total` variable to the sum of all table cells located above the
    current cell and returns an empty string
-   Related: `$GET()`, `SETM()`

[]{#FuncSETM}

### []{#SETM_name_formula_update_an_exis} SETM( name, formula ) \-- update an existing variable based on a formula

-   Specify the variable name (alphanumeric characters and underscores)
    and the formula. The formula must start with an operator to `+`
    (add), `-` (subtract), `*` (multiply), or `/` (divide) something to
    the variable. This function returns no output. Use `$GET()` to
    retrieve variables
-   Syntax: `$SETM( name, formula )`
-   Example: `%CALC{"$SETM(total, + $SUM($LEFT()))"}%` adds the sum of
    all table cells on the left to the `total` variable, and returns an
    empty string
-   Related: `$GET()`, `$SET()`

[]{#FuncSIGN}

### []{#SIGN_num_sign_of_a_number} SIGN( num ) \-- sign of a number

-   Returns -1 if `num` is negative, 0 if zero, or 1 if positive
-   Syntax: `$SIGN( num )`
-   Example: `%CALC{"$SIGN(-12.5)"}%` returns `-1`
-   Related: `$ABS()`, `$EVAL()`, `$INT()`, `$NOT()`

[]{#FuncSUBSTITUTE}

### []{#SUBSTITUTE_text_old_new_instance} SUBSTITUTE( text, old, new, instance, option ) \-- substitute text

-   Substitutes `new` text for `old` text in a `text` string. `instance`
    specifies which occurance of `old` you want to replace. If you
    specify `instance`, only that instance is replaced. Otherwise, every
    occurance is changed to the new text. A literal search is performed
    by default; a [RegularExpression](RegularExpression){.twikiLink}
    search if the `option` is set to `r`
-   Syntax: `$SUBSTITUTE( text, old, new, instance, option )`
-   Example: `%CALC{"$SUBSTITUTE(Good morning, morning, day)"}%` returns
    `Good day`
-   Example: `%CALC{"$SUBSTITUTE(Q2-2002,2,3)"}%` returns `Q3-3003`
-   Example: `%CALC{"$SUBSTITUTE(Q2-2002,2,3,3)"}%` returns `Q2-2003`
-   Example: `%CALC{"$SUBSTITUTE(abc123def,[0-9],9,,r)"}%` returns
    `abc999def`
-   Related: `$REPLACE()`, `$TRANSLATE()`

[]{#FuncSUM}

### []{#SUM_list_sum_of_a_list_or_range}[]{#SUM_list_sum_of_a_list_or_range_} SUM( list ) \-- sum of a list or range of cells

-   Syntax: `$SUM( list )`
-   Example: To sum up column 5 excluding the title row, write
    `%CALC{"$SUM(R2:C5..R$ROW(-1):C5)"}%` in the last row; or simply
    `%CALC{"$SUM($ABOVE())"}%`
-   Related: `$LIST()`, `$PRODUCT()`, `$SUMPRODUCT()`, `$WORKINGDAYS()`

[]{#FuncSUMDAYS}

### []{#SUMDAYS_list_sum_the_days_in_a_l} SUMDAYS( list ) \-- sum the days in a list or range of cells

-   The total number of days in a list or range of cells containing
    numbers of hours, days or weeks. The default unit is days; units are
    indicated by a `h`, `hours`, `d`, `days`, `w`, `weeks` suffix. One
    week is assumed to have 5 working days, one day 8 hours
-   Syntax: `$SUMDAYS( list )`
-   Example: `%CALC{"$SUMDAYS(2w, 1, 2d, 4h)"}%` returns `13.5`, the
    evaluation of `(2*5 + 1 + 2 + 4/8)`
-   Related: `$SUM()`, `$TIME()`, `$FORMATTIME()`

[]{#FuncSUMPRODUCT}

### []{#SUMPRODUCT_list_list_scalar_prod} SUMPRODUCT( list, list ) \-- scalar product on ranges of cells

-   Syntax: `$SUMPRODUCT( list, list, list... )`
-   Example: `%CALC{"$SUM(R2:C1..R4:C1, R2:C5..R4:C5)"}%` evaluates and
    returns the result of
    `($T(R2:C1) * $T(R2:C5) + $T(R3:C1) * $T(R3:C5) + $T(R4:C1) * $T(R4:C5))`
-   Related: `$LIST()`, `$PRODUCT()`, `$SUM()`

[]{#FuncT}

### []{#T_address_content_of_a_cell} T( address ) \-- content of a cell

-   Syntax: `$T( address )`
-   Example: `%CALC{"$T(R1:C5)"}%` returns the text in cell `R1:C5`
-   Related: `$COLUMN()`, `$ROW()`

[]{#FuncTRANSLATE}

### []{#TRANSLATE_text_from_to_translate} TRANSLATE( text, from, to ) \-- translate text from one set of characters to another

-   The translation is done `from` a set `to` a set, one character by
    one. The `text` may contain commas; all three parameters are
    required. In the `from` and `to` parameters you can write `$comma`
    to escape comma, `$sp` to escape space
-   Syntax: `$TRANSLATE( text, from, to )`
-   Example: `%CALC{"$TRANSLATE(boom,bm,cl)"}%` returns `cool`
-   Example: `%CALC{"$TRANSLATE(one, two,$comma,;)"}%` returns
    `one; two`
-   Related: `$REPLACE()`, `$SUBSTITUTE()`

[]{#FuncTIME}

### []{#TIME_text_convert_a_date_string}[]{#TIME_text_convert_a_date_string_} TIME( text ) \-- convert a date string into a serialized date number

-   Serialized date is seconds since the Epoch, e.g. midnight, 01
    Jan 1970. Current time is taken if the date string is empty.
    Supported date formats: `31 Dec 2009`; `31 Dec 2009 GMT`;
    `31 Dec 09`; `31-Dec-2009`; `31/Dec/2009`; `2009/12/31`;
    `2009-12-31`; `2009/12/31`; `2009/12/31 23:59`;
    `2009/12/31 - 23:59`; `2009-12-31-23-59`; `2009/12/31 - 23:59:59`;
    `2009.12.31.23.59.59`. Date is assumed to be server time; add `GMT`
    to indicate Greenwich time zone
-   Syntax: `$TIME( text )`
-   Example: `%CALC{"$TIME(2003/10/14 GMT)"}%` returns `1066089600`
-   Related: `$FORMATTIME()`, `$FORMATGMTIME()`, `$TIMEADD()`,
    `$TIMEDIFF()`, `$TODAY()`, `$WORKINGDAYS()`

[]{#FuncTIMEADD}

### []{#TIMEADD_serial_value_unit_add_a}[]{#TIMEADD_serial_value_unit_add_a_} TIMEADD( serial, value, unit ) \-- add a value to a serialized date

-   The unit is seconds if not specified; unit can be `second`,
    `minute`, `hour`, `day`, `week`, `month`, `year`. Note: An
    approximation is used for month and year calculations
-   Syntax: `$TIMEADD( serial, value, unit )`
-   Example: `%CALC{"$TIMEADD($TIME(), 2, week)"}%`
-   Related: `$()`, `$()` returns the serialized date two weeks from now
-   Related: `$FORMATTIME()`, `$FORMATGMTIME()`, `$TIME()`,
    `$TIMEDIFF()`, `$TODAY()`

[]{#FuncTIMEDIFF}

### []{#TIMEDIFF_serial_1_serial_2_unit}[]{#TIMEDIFF_serial_1_serial_2_unit_} TIMEDIFF( serial\_1, serial\_2, unit ) \-- time difference between two serialized dates

-   The unit is seconds if not specified; unit can be specified as in
    `$TIMEADD()`. Note: An approximation is used for month and year
    calculations. Use `$FORMAT()` or `$INT()` to format real numbers
-   Syntax: `$TIMEDIFF( serial_1, serial_2, unit )`
-   Example: `%CALC{"$TIMEDIFF($TIME(), $EVAL($TIME()+90), minute)"}%`
    returns `1.5`
-   Related: `$FORMAT()`, `$FORMATTIME()`, `$FORMATGMTIME()`, `$INT()`,
    `$TIME()`, `$TIMEADD()`, `$TODAY()`, `$WORKINGDAYS()`

[]{#FuncTODAY}

### []{#TODAY_serialized_date_of_today_a} TODAY( ) \-- serialized date of today at midnight GMT

-   In contrast, the related `$TIME()` returns the serialized date of
    today at the current time, e.g. it includes the number of seconds
    since midnight GMT
-   Syntax: `$TODAY( )`
-   Example: `%CALC{"$TODAY()"}%` returns the number of seconds since
    Epoch
-   Related: `$FORMATTIME()`, `$FORMATGMTIME()`, `$TIME()`,
    `$TIMEADD()`, `$TIMEDIFF()`

[]{#FuncTRIM}

### []{#TRIM_text_trim_spaces_from_text} TRIM( text ) \-- trim spaces from text

-   Removes all spaces from text except for single spaces between words
-   Syntax: `$TRIM( text )`
-   Example: `%CALC{"$TRIM( eat  spaces  )"}%` returns `eat spaces`
-   Related: `$EXACT()`, `$PROPERSPACE()`

[]{#FuncUPPER}

### []{#UPPER_text_upper_case_string_of}[]{#UPPER_text_upper_case_string_of_} UPPER( text ) \-- upper case string of a text

-   Syntax: `$UPPER( text )`
-   Example: `%CALC{"$UPPER($T(R1:C5))"}%` returns the upper case string
    of the text in cell `R1:C5`
-   Related: `$LOWER()`, `$PROPER()`, `$PROPERSPACE()`, `$TRIM()`

[]{#FuncVALUE}

### []{#VALUE_text_convert_text_to_numbe} VALUE( text ) \-- convert text to number

-   Extracts a number from `text`. Returns `0` if not found
-   Syntax: `$VALUE( text )`
-   Example: `%CALC{"$VALUE(US$1,200)"}%` returns `1200`
-   Example: `%CALC{"$VALUE(PrjNotebook1234)"}%` returns `1234`
-   Example: `%CALC{"$VALUE(Total: -12.5)"}%` returns `-12.5`
-   Related: `$EVAL()`, `$INT()`

[]{#FuncWORKINGDAYS}

### []{#WORKINGDAYS_serial_1_serial_2_wo} WORKINGDAYS( serial\_1, serial\_2 ) \-- working days between two serialized dates

-   Working days are Monday through Friday (sorry, Israel!)
-   Syntax: `$WORKINGDAYS( serial_1, serial_2 )`
-   Example:
    `%CALC{"$WORKINGDAYS($TIME(2004/07/15), $TIME(2004/08/03))"}%`
    returns `13`
-   Related: `$SUMDAYS()`, `$TIME()`, `$TIMEDIFF()`

[]{#Bug_Tracking_Example} Bug Tracking Example
----------------------------------------------

  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  [Bug\#:](SpreadSheetPlugin@sortcol=0&table=3&up=0#sorted_table "Sort by this column")   [Priority:](SpreadSheetPlugin@sortcol=1&table=3&up=0#sorted_table "Sort by this column")   [Subject:](SpreadSheetPlugin@sortcol=2&table=3&up=0#sorted_table "Sort by this column")   [Status:](SpreadSheetPlugin@sortcol=3&table=3&up=0#sorted_table "Sort by this column")     [Days to fix](SpreadSheetPlugin@sortcol=4&table=3&up=0#sorted_table "Sort by this column")
  --------------------------------------------------------------------------------------- ------------------------------------------------------------------------------------------ ----------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------- --------------------------------------------------------------------------------------------
  Bug:1231                                                                                Low                                                                                        File Open \...                                                                            Open                                                                                                                                                                                3

  Bug:1232                                                                                High                                                                                       Memory Window \...                                                                        Fixed                                                                                                                                                                               2

  Bug:1233                                                                                Medium                                                                                     Usability issue \...                                                                      Assigned                                                                                                                                                                            5

  Bug:1234                                                                                High                                                                                       No arrange \...                                                                           Fixed                                                                                                                                                                               1

  Total: 4                                                                                High: 2\                                                                                   .                                                                                         Assigned: 1\                                                                                                                                                                Total: 11
                                                                                          Low: 1\                                                                                                                                                                              Fixed: 2\                                                                                
                                                                                          Medium: 1                                                                                                                                                                            Open: 1                                                                                  
  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

The last row is defined as:

    | Total: %CALC{"$ROW(-2)"}% \ 
      | %CALC{"$COUNTITEMS( R2:C$COLUMN()..R$ROW(-1):C$COLUMN() )"}% | . \ 
      | %CALC{"$COUNTITEMS( R2:C$COLUMN()..R$ROW(-1):C$COLUMN() )"}% \ 
      |  Total: %CALC{"$SUM( R2:C$COLUMN()..R$ROW(-1):C$COLUMN() )"}% |

Above table is created manually. Another Plugin could build the table
dynamically, e.g. by pulling data out of a bug tracking system. The
Spreadsheet Plugin can be used to display table data statistics.

[]{#Plugin_Settings} Plugin Settings
------------------------------------

Plugin settings are stored as preferences variables. To reference a
plugin setting write `%<plugin>_<setting>%`, i.e.
`%SPREADSHEETPLUGIN_SHORTDESCRIPTION%`

-   One line description, is shown in the
    [TextFormattingRules](TextFormattingRules){.twikiLink} topic:
    -   Set SHORTDESCRIPTION = Add spreadsheet calculation like
        `"$SUM( $ABOVE() )"` to tables located in TWiki topics.

<!-- -->

-   Debug plugin: (See output in `data/debug.txt`)
    -   Set DEBUG = 0

<!-- -->

-   Do not handle `%CALC{}%` tag in included topic while including
    topic: (default: 1)
    -   Set SKIPINCLUDE = 1

<!-- -->

-   [WikiWords](WikiWord){.twikiLink} to exclude from being spaced out
    by the `$PROPERSPACE(text)` function. This comma delimited list can
    be overloaded by a DONTSPACE preferences variable:
    -   Set DONTSPACE = CodeWarrior, MacDonald, McIntosh, RedHat, SuSE

[]{#Plugin_Installation_Instructions} Plugin Installation Instructions
----------------------------------------------------------------------

***Note:*** You do not need to install anything on the browser to use
this plugin. Below installation instructions are for the administrator
who needs to install this plugin on the TWiki server.

-   Download the ZIP file from the SpreadSheetPlugin home
-   Unzip `SpreadSheetPlugin.zip` in your twiki installation directory.
    Content:
      [File:](SpreadSheetPlugin@sortcol=0&table=4&up=0#sorted_table "Sort by this column")   [Description:](SpreadSheetPlugin@sortcol=1&table=4&up=0#sorted_table "Sort by this column")
      -------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------
      `data/TWiki/SpreadSheetPlugin.txt`                                                     Plugin topic
      `data/TWiki/SpreadSheetPlugin.txt,v`                                                   Plugin topic repository
      `lib/TWiki/Plugins/SpreadSheetPlugin.pm`                                               Plugin Perl module

-   Test if the \"Total\" in the first table in this topic is correct.

[]{#Plugin_Info} Plugin Info
----------------------------

  ---------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
                                                                                                    Plugin Author: [TWiki:Main/PeterThoeny](http://twiki.org/cgi-bin/view/Main/PeterThoeny "'Main/PeterThoeny' on TWiki.org")
                                                                                                   Plugin Version: 17 Jul 2004
                                                                                                   Change History:  
                                                                                                      17 Jul 2004: Added \$WORKINGDAYS(), contributed by [TWiki:Main/CrawfordCurrie](http://twiki.org/cgi-bin/view/Main/CrawfordCurrie "'Main/CrawfordCurrie' on TWiki.org")
                                                                                                      24 May 2004: Refactored documentation (no code changes)
                                                                                                      03 Apr 2004: Added \$ABS(), \$LISTIF(); fixed \$VALUE() to remove leading zeros; changed \$FIND() and \$SEARCH() to return 0 instead of empty string if no match
                                                                                                      21 Mar 2004: Added \$LISTITEM(); fixed call to unofficial function
                                                                                                      16 Mar 2004: Added \$LISTMAP(), \$LISTREVERSE(), \$LISTSIZE(), \$LISTSORT(), \$LISTUNIQUE(), \$SETM(); retired \$COUNTUNIQUE() in favor of \$COUNTITEMS(\$LISTUNIQUE()); fixed evaluation order issue of \$IF(); fixed missing eval error messages suppressed since version 06 Mar 2004; redirect stderr messages to warning
                                                                                                      08 Mar 2004: Added \$LIST()
                                                                                                      06 Mar 2004: Added \$AND(), \$MOD(), \$NOT(), \$OR(), \$PRODUCT(), \$PROPER(), \$PROPERSPACE(), \$RAND(), \$REPEAT(), \$SIGN(), \$VALUE(); added digits parameter to \$ROUND(); renamed \$MULT() to \$PRODUCT(); \$MULT() is deprecated and undocumented
                                                                                                      27 Feb 2004: Added \$COUNTUNIQUE()
                                                                                                      24 Oct 2003: Added \$SET(), \$GET(), \$MEDIAN(); added \$SUMPRODUCT(), inspired by [TWiki:Main/RobertWithrow](http://twiki.org/cgi-bin/view/Main/RobertWithrow "'Main/RobertWithrow' on TWiki.org"); added \$SUMDAYS(), contributed by [TWiki:Main/SvenDowideit](http://twiki.org/cgi-bin/view/Main/SvenDowideit "'Main/SvenDowideit' on TWiki.org")
                                                                                                      21 Oct 2003: Added support for lists `(1, 2, 3)` and lists of table ranges `(R1:C1..R1:C5, R3:C1..R3:C5)` for all functions that accept a table range; added \$TIMEADD(); in \$TIMEDIFF() added week unit; in \$FORMATTIME() changed \$weekday to \$wd and added \$wday and \$weekday
                                                                                                      14 Oct 2003: Added \$TIME(), \$TODAY(), \$FORMATTIME(), \$FORMATGMTIME(), \$TIMEDIFF()
                                                                                                      13 Oct 2003: Added \$MULT(), contributed by [TWiki:Main/GerritJanBaarda](http://twiki.org/cgi-bin/view/Main/GerritJanBaarda "'Main/GerritJanBaarda' on TWiki.org")
                                                                                                      30 Jul 2003: Added \$TRANSLATE()
                                                                                                      19 Jul 2003: Added \$FIND(), \$NOP(), \$REPLACE(), \$SEARCH(), \$SUBSTITUTE(), contributed by [TWiki:Main/PaulineCheung](http://twiki.org/cgi-bin/view/Main/PaulineCheung "'Main/PaulineCheung' on TWiki.org")
                                                                                                      19 Apr 2003: Added \$COUNTSTR(), \$EXACT(), \$IF(), \$ROUND(), \$TRIM(); added \$FORMAT(), contributed by [TWiki:Main/JimStraus](http://twiki.org/cgi-bin/view/Main/JimStraus "'Main/JimStraus' on TWiki.org"); support `%` modulus operator in \$EVAL, \$INT, and \$ROUND; fixed bug in \$DEF
                                                                                                      07 Jun 2002: Added \$DEF(), contributed by [TWiki:Main/MartinFuzzey](http://twiki.org/cgi-bin/view/Main/MartinFuzzey "'Main/MartinFuzzey' on TWiki.org"); allow values with HTML formatting like `<u>102</u>`, suggested by [TWiki:Main/GladeDiviney](http://twiki.org/cgi-bin/view/Main/GladeDiviney "'Main/GladeDiviney' on TWiki.org"); added SKIPINCLUDE setting
                                                                                                      12 Mar 2002: Support for multiple functions per nesting level
                                                                                                      15 Jan 2002: Added \$CHAR(), \$CODE() and \$LENGTH()
                                                                                                      12 Nov 2001: Added \$RIGHT()
                                                                                                      12 Aug 2001: Fixed bug of disappearing multi-column cells
                                                                                                      19 Jul 2001: Fixed incorrect \$SUM calculation of cell with value `0`
                                                                                                      14 Jul 2001: Changed to plug & play
                                                                                                      01 Jun 2001: Fixed insecure dependencies for \$MIN and \$MAX
                                                                                                      16 Apr 2001: Fixed div by 0 bug in \$AVERAGE
                                                                                                      17 Mar 2001: Initial version
                                                                                                CPAN Dependencies: none
    [TWiki:Plugins/Benchmark](http://twiki.org/cgi-bin/view/Plugins/Benchmark "'Plugins/Benchmark' on TWiki.org"): [GoodStyle](GoodStyle){.twikiLink} 99%, [FormattedSearch](FormattedSearch){.twikiLink} 99%, [SpreadSheetPlugin](SpreadSheetPlugin){.twikiLink} 95%
                                                                                               Other Dependencies: none
                                                                                                     Perl Version: 5.000 and up
                                                                                                      Plugin Home: <http://TWiki.org/cgi-bin/view/Plugins/SpreadSheetPlugin>
                                                                                                         Feedback: <http://TWiki.org/cgi-bin/view/Plugins/SpreadSheetPluginDev>
  ---------------------------------------------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

***Related Topics:*** [TWikiPreferences](TWikiPreferences){.twikiLink},
[TWikiPlugins](TWikiPlugins){.twikiLink}

\--
[TWiki:Main/PeterThoeny](http://twiki.org/cgi-bin/view/Main/PeterThoeny "'Main/PeterThoeny' on TWiki.org")
- 17 Jul 2004\
[]{#TopicEnd}

::: {.twikiTopicInfo .twikiRevInfo .twikiGrayText .twikiMoved}
:::
