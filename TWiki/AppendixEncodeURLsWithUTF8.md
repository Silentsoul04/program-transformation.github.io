::: {.fullPage}
::: {.twikiMiddleContainer}
::: {.twikiLeftBar}
::: {.twikiLeftBarContents}
**[TWiki](http://TWiki.org/)**

-   **[Welcome](WelcomeGuest){.twikiLink}**
-   **[Register](TWikiRegistration){.twikiLink}**

------------------------------------------------------------------------

-   **TWiki Web**
-   [TWiki Web Home](WebHome){.twikiLink}
-   [Changes](WebChanges){.twikiLink}
-   [Topics](WebTopicList){.twikiLink}
-   [Index](WebIndex){.twikiLink}
-   [Search](WebSearch){.twikiLink}

------------------------------------------------------------------------

-   **TWiki Webs**
    -   [BX12](../BX12/WebHome){.twikiLink}
    -   [Book](../Book/WebHome){.twikiLink}
    -   [CC[^?^](http://www.program-transformation.org/edit/CC/WebHome?topicparent=TWiki.AppendixEncodeURLsWithUTF8)]{.twikiNewLink
        style="background : #FFFFCE;"}
    -   [Compare](../Compare/WebHome){.twikiLink}
    -   [GPCE06](../GPCE06/WebHome){.twikiLink}
    -   [GPCE08](../GPCE08/WebHome){.twikiLink}
    -   [GPCE09](../GPCE09/WebHome){.twikiLink}
    -   [GPCE10](../GPCE10/WebHome){.twikiLink}
    -   [GPCE11](../GPCE11/WebHome){.twikiLink}
    -   [GPCE12](../GPCE12/WebHome){.twikiLink}
    -   [GPCE13](../GPCE13/WebHome){.twikiLink}
    -   [GPCE14](../GPCE14/WebHome){.twikiLink}
    -   [Gmt](../Gmt/WebHome){.twikiLink}
    -   [Gpce](../Gpce/WebHome){.twikiLink}
    -   [Gpce03](http://www.program-transformation.org/Gpce03/WebHome){.twikiLink}
    -   [Gpce04](../Gpce04/WebHome){.twikiLink}
    -   [Gpce05](../Gpce05/WebHome){.twikiLink}
    -   [Gpceorg](../Gpceorg/WebHome){.twikiLink}
    -   [HART14](../HART14/WebHome){.twikiLink}
    -   [IFIPWG211](http://www.program-transformation.org/IFIPWG211/WebHome){.twikiLink}
    -   [IPA06](../IPA06/WebHome){.twikiLink}
    -   [Main](../Main/WebHome){.twikiLink}
    -   [Octave](../Octave/WebHome){.twikiLink}
    -   [PEPM07](../PEPM07/WebHome){.twikiLink}
    -   [PEPM08](../PEPM08/WebHome){.twikiLink}
    -   [PEPM10](../PEPM10/WebHome){.twikiLink}
    -   [PEPM11](../PEPM11/WebHome){.twikiLink}
    -   [PEPM12](../PEPM12/WebHome){.twikiLink}
    -   [PEPM13](../PEPM13/WebHome){.twikiLink}
    -   [PEPM14](../PEPM14/WebHome){.twikiLink}
    -   [PHP](../PHP/WebHome){.twikiLink}
    -   [Sandbox](../Sandbox/WebHome){.twikiLink}
    -   [Sdf](../Sdf/WebHome){.twikiLink}
    -   [SdfBackup](../SdfBackup/WebHome){.twikiLink}
    -   [Spoofax](../Spoofax/WebHome){.twikiLink}
    -   [Stratego](../Stratego/WebHome){.twikiLink}
    -   [Sts](../Sts/WebHome){.twikiLink}
    -   [TWiki](WebHome){.twikiLink}
    -   [Tiger](../Tiger/WebHome){.twikiLink}
    -   [Tools](../Tools/WebHome){.twikiLink}
    -   [Transform](../Transform/WebHome){.twikiLink}
    -   [Variability](../Variability/WebHome){.twikiLink}
    -   [WGLD](../WGLD/WebHome){.twikiLink}
    -   [WebDSL](../WebDSL/WebHome){.twikiLink}
    -   [default](DefaultWebHome){.twikiLink}

::: {.twikiLeftBarPersonal}
::: {style="overflow:auto; height:1px; width:1px;"}
Changes Index Search

------------------------------------------------------------------------

Webs Book Compare GPCE06 Gmt Gpce Gpce04 Gpce05 IFIPWG211 IPA06 Main
Octave PEPM07 PEPM08 PHP Sandbox Sdf Stratego Sts TWiki Tiger Tools
Transform Variability default
[porn](http://www.estrategiavirtual.com/adult/) [free
porn](http://www.estrategiavirtual.com/free/)
:::
:::
:::
:::

::: {.twikiMain}
::: {.toolBar}
::: {.flexMenuBar}
::: {.flexMenu onmouseover="return showMenu(event, 100);" onmouseout="return hideMenu(event, 100);"}
Page

::: {#flexMenuContent100 .flexMenuContent}
-   [Edit
    Page](http://www.program-transformation.org/edit/TWiki/AppendixEncodeURLsWithUTF8?t=1536827486)
-   [Rename
    Page](http://www.program-transformation.org/rename/TWiki/AppendixEncodeURLsWithUTF8)
-   [Attach
    File](http://www.program-transformation.org/attach/TWiki/AppendixEncodeURLsWithUTF8)

<!-- -->

-   [Printable](http://www.program-transformation.org/view/TWiki/AppendixEncodeURLsWithUTF8?skin=print.pattern)
-   [Wiki
    Source](http://www.program-transformation.org/view/TWiki/AppendixEncodeURLsWithUTF8?skin=text&raw=on&contenttype=text/plain)

<!-- -->

-   [Rev
    1](http://www.program-transformation.org/view/TWiki/AppendixEncodeURLsWithUTF8?rev=1.1)
-   [Total
    History](http://www.program-transformation.org/rdiff/TWiki/AppendixEncodeURLsWithUTF8)

<!-- -->

-   [More
    \...](http://www.program-transformation.org/oops/TWiki/AppendixEncodeURLsWithUTF8?template=oopsmore&param1=1.1&param2=1.1)
:::
:::

::: {.flexMenu onmouseover="return showMenu(event, 102);" onmouseout="return hideMenu(event, 102);"}
Web

::: {#flexMenuContent102 .flexMenuContent}
-   [Recent Changes](WebChanges){.twikiLink}
-   [Notify Service](WebNotify){.twikiLink}
-   [News](WebNews){.twikiLink}

<!-- -->

-   [Page Index](WebIndex){.twikiLink}
-   [Search](WebSearch){.twikiLink}

<!-- -->

-   [More
    \...](http://www.program-transformation.org/oops/TWiki/AppendixEncodeURLsWithUTF8?template=oopsmore&param1=1.1&param2=1.1)
:::
:::

::: {.flexMenu onmouseover="return showMenu(event, 103);" onmouseout="return hideMenu(event, 103);"}
Wiki

::: {#flexMenuContent103 .flexMenuContent}
-   [About
    TWiki](http://www.program-transformation.org/view/TWiki/WebHome)
-   [Text
    Formatting](http://www.program-transformation.org/view/TWiki/TextFormattingRules)

<!-- -->

-   [Registration](http://www.program-transformation.org/view/TWiki/TWikiRegistration)
-   [Change
    Password](http://www.program-transformation.org/view/TWiki/ChangePassword)
-   [Reset
    Password](http://www.program-transformation.org/view/TWiki/ResetPassword)

<!-- -->

-   [Users](http://www.program-transformation.org/view/Main/TWikiUsers)
-   [Groups](http://www.program-transformation.org/view/Main/TWikiGroups)
:::
:::
:::
:::

::: {.twikiTopic}
Appendix Encode URLs With UTF8 {#appendix-encode-urls-with-utf8 .twikiTopicTitle}
==============================

::: {.twikiWebTitle}
TWiki
:::

::: {.twikiToc}
-   [Appendix C: Encode URLs With
    UTF8](AppendixEncodeURLsWithUTF8#Appendix_C_Encode_URLs_With_UTF8)
    -   [Current Status](AppendixEncodeURLsWithUTF8#Current_Status)
    -   [Details of
        Implementation](AppendixEncodeURLsWithUTF8#Details_of_Implementation)
    -   [Testing and
        Limitation](AppendixEncodeURLsWithUTF8#Testing_and_Limitation)
:::

[]{#EncodeURLsUTF8}

[]{#Appendix_C_Encode_URLs_With_UTF8} Appendix C: Encode URLs With UTF8
=======================================================================

*This page addresses implemented UTF-8 support for URLs only. The
overall plan for UTF-8 support for TWiki is described in
[TWiki:Codev.ProposedUTF8SupportForI18N](http://twiki.org/cgi-bin/view/Codev.ProposedUTF8SupportForI18N "'Codev.ProposedUTF8SupportForI18N' on TWiki.org")
.*

[]{#Current_Status} Current Status
----------------------------------

To simplify use of internationalised characters within
[WikiWords](WikiWord){.twikiLink} and attachment names, TWiki now
supports UTF-8 URLs, converting on-the-fly to virtually any character
set, including ISO-8859-\*, KOI8-R, EUC-JP, and so on.

Support for UTF-8 URL encoding avoids having to configure the browser to
turn off this encoding in URLs (the default in Internet Explorer, Opera
Browser and some Mozilla Browser URLs) and enables support of browsers
where only this mode is supported (e.g. Opera Browser for Symbian
smartphones). A non-UTF-8 site character set (e.g. ISO-8859-\*) is still
used within TWiki, and in fact pages are stored and viewed entirely in
the site character set - the browser dynamically converts URLs from the
site character set into UTF-8, and TWiki converts them back again.

System requirements are updated as follows:

-   ASCII or ISO-8859-1-only sites do not require any additional CPAN
    modules to be installed.
-   Perl 5.8 sites using any character set do not require additional
    modules, since CPAN:Encode is installed as part of Perl.
-   This feature still works on Perl 5.005\_03 as per
    [TWikiSystemRequirements](TWikiSystemRequirements){.twikiLink}, or
    Perl 5.6, as long as CPAN:Unicode::MapUTF8 is installed.

ISO-2022-\*, HZ-\* and other \'non-ASCII-safe\' multi-byte character
sets are now specifically excluded from use as the site character set,
since they interfere with TWiki ML; however, many multi-byte character
sets work fine, e.g. EUC-JP, GB2312, etc.

It\'s now possible to override the site character set defined in the
`$siteLocale` setting in TWiki.cfg - this enables you to have a slightly
different spelling of the character set in the server locale (e.g.
\'eucjp\') and the HTTP header sent to the browser (e.g. \'euc-jp\').

This feature should also support use of Mozilla Browser with
[TWiki:Codev.TWikiOnMainframe](http://twiki.org/cgi-bin/view/Codev.TWikiOnMainframe "'Codev.TWikiOnMainframe' on TWiki.org")
(as long as mainframe web server can convert or pass through UTF-8 URLs)
- however, this specific combination is not tested. Other browser-server
combinations should not have any problems.

Please note that use of UTF-8 as the site character set is not yet
supported - see Phase 2 of
[TWiki:Codev.ProposedUTF8SupportForI18N](http://twiki.org/cgi-bin/view/Codev.ProposedUTF8SupportForI18N "'Codev.ProposedUTF8SupportForI18N' on TWiki.org")
for plans and work to date in this area.

This feature is complete in TWiki releases newer than February 2004.

Note for skin developers: %INTURLENCODE% is no longer required
([TWiki:Plugins.InternationalisingYourSkin](http://twiki.org/cgi-bin/view/Plugins.InternationalisingYourSkin "'Plugins.InternationalisingYourSkin' on TWiki.org")).

[]{#Details_of_Implementation} Details of Implementation
--------------------------------------------------------

URLs are not allowed to contain non-ASCII (8th bit set) characters:
<http://www.w3.org/TR/html4/appendix/notes.html#non-ascii-chars>

The overall plan for UTF-8 support for TWiki is described in two phases
in
[TWiki:/Codev.ProposedUTF8SupportForI18N](http://twiki.org/cgi-bin/view//Codev.ProposedUTF8SupportForI18N "'/Codev.ProposedUTF8SupportForI18N' on TWiki.org")
- this page addresses the first phase, in which UTF-8 is supported for
URLs only.

UTF-8 URL translation to virtually any character set is supported as of
TWiki Release 01 Sep 2004, but full UTF-8 support (e.g. pages in UTF-8)
is not supported yet - this will be phase 2.

The code automatically detects whether a URL is UTF-8 or not, taking
care to avoid over-long and illegal UTF-8 encodings that could introduce
[TWiki:Codev.MajorSecurityProblemWithIncludeFileProcessing](http://twiki.org/cgi-bin/view/Codev.MajorSecurityProblemWithIncludeFileProcessing "'Codev.MajorSecurityProblemWithIncludeFileProcessing' on TWiki.org")
(tested against a comprehensive [UTF-8 test
file](http://www.cl.cam.ac.uk/~mgk25/ucs/examples/UTF-8-test.txt), which
IE 5.5 fails quite dangerously, and Opera Browser passes). Any non-ASCII
URLs that are *not* valid UTF-8 are then assumed to be directly
URL-encoded as a single-byte or multi-byte character set (as now), e.g.
EUC-JP.

The main point is that you can use TWiki with international characters
in [WikiWords](WikiWord){.twikiLink} without changing your browser setup
from the default, and you can also still use TWiki using non-UTF-8 URLs.
This works on any Perl version from 5.005\_03 onwards and corresponds to
Phase 1 of
[TWiki:Codev.ProposedUTF8SupportForI18N](http://twiki.org/cgi-bin/view/Codev.ProposedUTF8SupportForI18N "'Codev.ProposedUTF8SupportForI18N' on TWiki.org").
You can have different users using different URL formats transparently
on the same server.

UTF-8 URLs are automatically converted to the current `$siteCharset`
(from the `TWiki.cfg` locale setting), using modules such as CPAN:Encode
if needed.

TWiki generates the whole page in the site charset, e.g. ISO-8859-1 or
EUC-JP, but the browser dynamically UTF-8 encodes the attachment\'s URL
when it\'s used. Since Apache serves attachment downloads without TWiki
being involved, TWiki\'s code can\'t do its UTF-8 decoding trick, so
TWiki URL-encodes such URLs in ISO-8859-1 or whatever when generating
the page, to bypass this URL encoding, ensuring that the URLs and
filenames seen by Apache remain in the site charset.

[TWiki:Codev.TWikiOnMainframe](http://twiki.org/cgi-bin/view/Codev.TWikiOnMainframe "'Codev.TWikiOnMainframe' on TWiki.org")
uses EBCDIC web servers that typically translate their output to ASCII,
UTF-8 or ISO-8859-1 (and URLs in the other direction) since there are so
few EBCDIC web browsers. Such web servers don\'t work with even
ISO-8859-1 URLs if they are URL encoded, since the automated translation
is bypassed for URL-encoded characters. For TWiki on Mainframe, TWiki
assumes that the web server will automatically translate UTF-8 URLs into
EBCDIC URLs, as long as URL encoding is turned off in TWiki pages.

[]{#Testing_and_Limitation} Testing and Limitation
--------------------------------------------------

It should work with
[TWiki:Codev.TWikiOnMainframe](http://twiki.org/cgi-bin/view/Codev.TWikiOnMainframe "'Codev.TWikiOnMainframe' on TWiki.org").
Tested with IE 5.5, Opera 7.11 and Mozilla (Firebird 0.7).

Opera Browser on the P800 smartphone is working for page viewing but
leads to corrupt page names when editing pages.

For up to date information see
[TWiki:Codev.EncodeURLsWithUTF8](http://twiki.org/cgi-bin/view/Codev.EncodeURLsWithUTF8 "'Codev.EncodeURLsWithUTF8' on TWiki.org")

\--
[TWiki:Main.RichardDonkin](http://twiki.org/cgi-bin/view/Main.RichardDonkin "'Main.RichardDonkin' on TWiki.org")
- 7 Jan 2004\
\--
[TWiki:Main.MattWilkie](http://twiki.org/cgi-bin/view/Main.MattWilkie "'Main.MattWilkie' on TWiki.org")
- 10 Aug 2004\
\--
[TWiki:Main.PeterThoeny](http://twiki.org/cgi-bin/view/Main.PeterThoeny "'Main.PeterThoeny' on TWiki.org")
- 14 Aug 2004

\
[]{#TopicEnd}
:::

::: {.twikiTopicInfo .twikiRevInfo .twikiGrayText .twikiMoved}
:::
:::
:::
:::
